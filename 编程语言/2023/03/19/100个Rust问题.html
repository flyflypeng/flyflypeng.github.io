<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>100ä¸ªRusté—®é¢˜</title>
  <meta name="description"
    content="è¯´æ˜è¿™æ˜¯ä¸€ä¸ªæˆ‘è‡ªå·±åœ¨å­¦ä¹ Rustè¯­è¨€ä¸­è®°å½•çš„ä¸€é—ªè€Œè¿‡ä¸æ˜ç™½æƒ³æ·±å…¥æ¢ç©¶æˆ–è€…åœ¨å†™ä»£ç ä¸­ç»å¸¸ä¼šå»æœç´¢æ‰èƒ½è·å–åˆ°ç­”æ¡ˆçš„ä¸€äº›é—®é¢˜ã€‚è¿™ç¯‡æ–‡ç« å¸Œæœ›å¯ä»¥ç»™å¤§å®¶å½“åšæ˜¯ä¸€ä¸ªFAQæ¥ä½¿ç”¨ï¼Œé‡åˆ°Rustç›¸å…³çš„å›°æƒ‘æ—¶ï¼Œç›´æ¥Ctrl + Fã€‚å¸Œæœ›å®ƒæ¯”ChatGPTç»™å‡ºçš„ç­”æ¡ˆæ›´æ¥è¿‘ä½ æƒ³è¦å¾—åˆ°çš„æ ‡å‡†ç­”æ¡ˆï¼1. Rust examplesæ ·ä¾‹ç¨‹åº...">
  
  <meta name="author" content="Pengfei Jiang">
  <meta name="copyright" content="&copy; Pengfei Jiang 2023">
  

  <!-- External libraries -->
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
  <link rel="stylesheet"
    href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/monokai-sublime.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/css/lightbox.css">

  <!-- Favicon and other icons (made with http://www.favicon-generator.org/) -->
  <link rel="shortcut icon" href=" /assets/icons/favicon.ico" type="image/x-icon">
  <link rel="icon" href=" /assets/icons/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" sizes="57x57" href=" /assets/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href=" /assets/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href=" /assets/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href=" /assets/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href=" /assets/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href=" /assets/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href=" /assets/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href=" /assets/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href=" /assets/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href=" /assets/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href=" /assets/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href=" /assets/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href=" /assets/icons/favicon-16x16.png">
  <link rel="manifest" href=" /assets/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content=" /assets/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">

  
  <!-- Facebook OGP cards -->
  <meta property="og:description"
    content="è¯´æ˜è¿™æ˜¯ä¸€ä¸ªæˆ‘è‡ªå·±åœ¨å­¦ä¹ Rustè¯­è¨€ä¸­è®°å½•çš„ä¸€é—ªè€Œè¿‡ä¸æ˜ç™½æƒ³æ·±å…¥æ¢ç©¶æˆ–è€…åœ¨å†™ä»£ç ä¸­ç»å¸¸ä¼šå»æœç´¢æ‰èƒ½è·å–åˆ°ç­”æ¡ˆçš„ä¸€äº›é—®é¢˜ã€‚è¿™ç¯‡æ–‡ç« å¸Œæœ›å¯ä»¥ç»™å¤§å®¶å½“åšæ˜¯ä¸€ä¸ªFAQæ¥ä½¿ç”¨ï¼Œé‡åˆ°Rustç›¸å…³çš„å›°æƒ‘æ—¶ï¼Œç›´æ¥Ctrl + Fã€‚å¸Œæœ›å®ƒæ¯”ChatGPTç»™å‡ºçš„ç­”æ¡ˆæ›´æ¥è¿‘ä½ æƒ³è¦å¾—åˆ°çš„æ ‡å‡†ç­”æ¡ˆï¼1. Rust examplesæ ·ä¾‹ç¨‹åº..." />
  <meta property="og:url" content="http://localhost:4000" />
  <meta property="og:site_name" content="Fly Higher's Blog" />
  <meta property="og:title" content="100ä¸ªRusté—®é¢˜" />
  <meta property="og:type" content="website" />
  <meta property="og:image"
    content="http://localhost:4000https://picturebed.obs.cn-east-2.myhuaweicloud.com/blogPictures/20230320145945.png" />
  <meta property="og:image:type" content="image/png" />
  <meta property="og:image:width" content="612" />
  <meta property="og:image:height" content="605" />
  

  
  <!-- Twitter: card tags -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="100ä¸ªRusté—®é¢˜">
  <meta name="twitter:description"
    content="è¯´æ˜è¿™æ˜¯ä¸€ä¸ªæˆ‘è‡ªå·±åœ¨å­¦ä¹ Rustè¯­è¨€ä¸­è®°å½•çš„ä¸€é—ªè€Œè¿‡ä¸æ˜ç™½æƒ³æ·±å…¥æ¢ç©¶æˆ–è€…åœ¨å†™ä»£ç ä¸­ç»å¸¸ä¼šå»æœç´¢æ‰èƒ½è·å–åˆ°ç­”æ¡ˆçš„ä¸€äº›é—®é¢˜ã€‚è¿™ç¯‡æ–‡ç« å¸Œæœ›å¯ä»¥ç»™å¤§å®¶å½“åšæ˜¯ä¸€ä¸ªFAQæ¥ä½¿ç”¨ï¼Œé‡åˆ°Rustç›¸å…³çš„å›°æƒ‘æ—¶ï¼Œç›´æ¥Ctrl + Fã€‚å¸Œæœ›å®ƒæ¯”ChatGPTç»™å‡ºçš„ç­”æ¡ˆæ›´æ¥è¿‘ä½ æƒ³è¦å¾—åˆ°çš„æ ‡å‡†ç­”æ¡ˆï¼1. Rust examplesæ ·ä¾‹ç¨‹åº...">
  <meta name="twitter:image"
    content="http://localhost:4000https://picturebed.obs.cn-east-2.myhuaweicloud.com/blogPictures/20230320145945.png">
  <meta name="twitter:url" content="http://localhost:4000">
  

  

  <!-- Site styles -->
  <link rel="stylesheet" href=" /css/main.css">
  <link rel="canonical" href="http://localhost:4000/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/2023/03/19/100%E4%B8%AARust%E9%97%AE%E9%A2%98.html">
  <link rel="alternate" type="application/rss+xml" title="Fly Higher's Blog" href="http://localhost:4000 /feed.xml" />

  <!-- Google analytics -->
  
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WQJMFGY2LD"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-WQJMFGY2LD');
</script>
  
</head>

  <body>

    <header class="navigation" role="banner">
  <div class="navigation-wrapper">
    <a href="/" class="logo">
      
      <img src="/assets/smile_icon.png" alt="Fly Higher's Blog">
      
    </a>
    <a href="javascript:void(0)" class="navigation-menu-button" id="js-mobile-menu">
      <i class="fa fa-bars"></i>
    </a>
    <nav role="navigation">
      <ul id="js-navigation-menu" class="navigation-menu show">
        <li class="nav-link"><a href="/about/">About</a>
        <li class="nav-link"><a href="/posts/">Posts</a>
        <li class="nav-link"><a href="/project/">Projects</a>
        <!-- 
          
          <li class="nav-link"><a href="/about/">About</a>
          
        
          
        
          
        
          
        
          
          <li class="nav-link"><a href="/posts/">Posts</a>
          
        
          
          <li class="nav-link"><a href="/project/">Projects</a>
          
        
          
          <li class="nav-link"><a href="/tag/keyboard/">keyboard</a>
          
        
          
          <li class="nav-link"><a href="/tag/virtual/">virtual</a>
          
        
          
          <li class="nav-link"><a href="/tag/android/">Android</a>
          
        
          
          <li class="nav-link"><a href="/tag/opencv/">opencv</a>
          
        
          
          <li class="nav-link"><a href="/tag/markdown/">Markdown</a>
          
        
          
          <li class="nav-link"><a href="/tag/%E8%8B%B1%E8%AF%AD/">è‹±è¯­</a>
          
        
          
          <li class="nav-link"><a href="/tag/%E5%AD%A6%E4%B9%A0/">å­¦ä¹ </a>
          
        
          
          <li class="nav-link"><a href="/tag/hexo/">Hexo</a>
          
        
          
          <li class="nav-link"><a href="/tag/%E5%8D%9A%E5%AE%A2/">åšå®¢</a>
          
        
          
          <li class="nav-link"><a href="/tag/ubuntu/">Ubuntu</a>
          
        
          
          <li class="nav-link"><a href="/tag/firefox/">Firefox</a>
          
        
          
          <li class="nav-link"><a href="/tag/python/">Python</a>
          
        
          
          <li class="nav-link"><a href="/tag/make/">make</a>
          
        
          
          <li class="nav-link"><a href="/tag/makefile/">Makefile</a>
          
        
          
          <li class="nav-link"><a href="/tag/linux/">Linux</a>
          
        
          
          <li class="nav-link"><a href="/tag/sublimetext/">SublimeText</a>
          
        
          
          <li class="nav-link"><a href="/tag/%E5%86%85%E6%A0%B8/">å†…æ ¸</a>
          
        
          
          <li class="nav-link"><a href="/tag/%E8%B0%83%E5%BA%A6/">è°ƒåº¦</a>
          
        
          
          <li class="nav-link"><a href="/tag/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">æ“ä½œç³»ç»Ÿ</a>
          
        
          
          <li class="nav-link"><a href="/tag/%E7%A1%AC%E7%9B%98/">ç¡¬ç›˜</a>
          
        
          
          <li class="nav-link"><a href="/tag/%E8%AE%A1%E7%AE%97%E6%9C%BA/">è®¡ç®—æœº</a>
          
        
          
          <li class="nav-link"><a href="/tag/terminator/">Terminator</a>
          
        
          
          <li class="nav-link"><a href="/tag/cpu/">CPU</a>
          
        
          
          <li class="nav-link"><a href="/tag/%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/">ä½“ç³»ç»“æ„</a>
          
        
          
          <li class="nav-link"><a href="/tag/%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8/">ç³»ç»Ÿè°ƒç”¨</a>
          
        
          
          <li class="nav-link"><a href="/tag/%E6%97%B6%E9%97%B4%E7%AE%A1%E7%90%86/">æ—¶é—´ç®¡ç†</a>
          
        
          
          <li class="nav-link"><a href="/tag/vnc/">VNC</a>
          
        
          
          <li class="nav-link"><a href="/tag/rfb/">RFB</a>
          
        
          
          <li class="nav-link"><a href="/tag/container-of/">container_of</a>
          
        
          
          <li class="nav-link"><a href="/tag/offsetof/">offsetof</a>
          
        
          
          <li class="nav-link"><a href="/tag/cs/">CS</a>
          
        
          
          <li class="nav-link"><a href="/tag/%E5%9F%BA%E7%A1%80/">åŸºç¡€</a>
          
        
          
          <li class="nav-link"><a href="/tag/%E9%98%85%E8%AF%BB/">é˜…è¯»</a>
          
        
          
          <li class="nav-link"><a href="/tag/%E4%B9%A6%E5%8D%95/">ä¹¦å•</a>
          
        
          
          <li class="nav-link"><a href="/tag/%E5%B0%8F%E8%AF%B4/">å°è¯´</a>
          
        
          
          <li class="nav-link"><a href="/tag/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a>
          
        
          
          <li class="nav-link"><a href="/tag/ndk/">NDK</a>
          
        
          
          <li class="nav-link"><a href="/tag/debug/">Debug</a>
          
        
          
          <li class="nav-link"><a href="/tag/tombstone/">Tombstone</a>
          
        
          
          <li class="nav-link"><a href="/tag/eof/">EOF</a>
          
        
          
          <li class="nav-link"><a href="/tag/git/">Git</a>
          
        
          
          <li class="nav-link"><a href="/tag/ppa/">PPA</a>
          
        
          
          <li class="nav-link"><a href="/tag/apt/">APT</a>
          
        
          
          <li class="nav-link"><a href="/tag/%E5%90%8C%E6%AD%A5/">åŒæ­¥</a>
          
        
          
          <li class="nav-link"><a href="/tag/%E7%94%9F%E4%BA%A7%E8%80%85%E6%B6%88%E8%B4%B9%E8%80%85/">ç”Ÿäº§è€…æ¶ˆè´¹è€…</a>
          
        
          
          <li class="nav-link"><a href="/tag/%E7%8E%AF%E5%BD%A2%E7%BC%93%E5%86%B2%E5%8C%BA/">ç¯å½¢ç¼“å†²åŒº</a>
          
        
          
          <li class="nav-link"><a href="/tag/ringbuffer/">RingBuffer</a>
          
        
          
          <li class="nav-link"><a href="/tag/aosp/">AOSP</a>
          
        
          
          <li class="nav-link"><a href="/tag/hal/">HAL</a>
          
        
          
          <li class="nav-link"><a href="/tag/ramfs/">ramfs</a>
          
        
          
          <li class="nav-link"><a href="/tag/tmpfs/">tmpfs</a>
          
        
          
          <li class="nav-link"><a href="/tag/rootfs/">rootfs</a>
          
        
          
          <li class="nav-link"><a href="/tag/initramfs/">initramfs</a>
          
        
          
          <li class="nav-link"><a href="/tag/%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/">æ–‡ä»¶ç³»ç»Ÿ</a>
          
        
          
          <li class="nav-link"><a href="/tag/unix/">Unix</a>
          
        
          
          <li class="nav-link"><a href="/tag/i-o/">I/O</a>
          
        
          
          <li class="nav-link"><a href="/tag/graphic/">Graphic</a>
          
        
          
          <li class="nav-link"><a href="/tag/opengles/">OpenGLES</a>
          
        
          
          <li class="nav-link"><a href="/tag/egl/">EGL</a>
          
        
          
          <li class="nav-link"><a href="/tag/%E8%99%9A%E6%8B%9F%E5%8C%96/">è™šæ‹ŸåŒ–</a>
          
        
          
          <li class="nav-link"><a href="/tag/qemu/">QEMU</a>
          
        
          
          <li class="nav-link"><a href="/tag/kvm/">KVM</a>
          
        
          
          <li class="nav-link"><a href="/tag/mac/">Mac</a>
          
        
          
          <li class="nav-link"><a href="/tag/jekyll/">Jekyll</a>
          
        
          
          <li class="nav-link"><a href="/tag/iterm2/">iTerm2</a>
          
        
          
          <li class="nav-link"><a href="/tag/zsh/">zsh</a>
          
        
          
          <li class="nav-link"><a href="/tag/kubernetes/">kubernetes</a>
          
        
          
          <li class="nav-link"><a href="/tag/k8s/">k8s</a>
          
        
          
          <li class="nav-link"><a href="/tag/cloudnative/">cloudnative</a>
          
        
          
          <li class="nav-link"><a href="/tag/%E6%88%B7%E5%A4%96/">æˆ·å¤–</a>
          
        
          
          <li class="nav-link"><a href="/tag/%E9%9C%B2%E8%90%A5/">éœ²è¥</a>
          
        
          
          <li class="nav-link"><a href="/tag/camp/">camp</a>
          
        
          
          <li class="nav-link"><a href="/tag/%E7%AC%94%E8%AE%B0/">ç¬”è®°</a>
          
        
          
          <li class="nav-link"><a href="/tag/%E4%BA%91%E5%8E%9F%E7%94%9F/">äº‘åŸç”Ÿ</a>
          
        
          
          <li class="nav-link"><a href="/tag/ptrace/">ptrace</a>
          
        
          
          <li class="nav-link"><a href="/tag/sandbox/">sandbox</a>
          
        
          
          <li class="nav-link"><a href="/tag/kata-containers/">kata-containers</a>
          
        
          
          <li class="nav-link"><a href="/tag/vscode/">vscode</a>
          
        
          
          <li class="nav-link"><a href="/tag/kernel/">kernel</a>
          
        
          
          <li class="nav-link"><a href="/tag/mlsys/">MLSys</a>
          
        
          
          <li class="nav-link"><a href="/tag/%E8%AE%BA%E6%96%87/">è®ºæ–‡</a>
          
        
          
          <li class="nav-link"><a href="/tag/ai/">AI</a>
          
        
          
          <li class="nav-link"><a href="/tag/rust/">Rust</a>
          
        
          
          <li class="nav-link"><a href="/tag/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/">ç¼–ç¨‹è¯­è¨€</a>
          
        
          
          <li class="nav-link"><a href="/tag/overlayfs/">OverlayFs</a>
          
        
          
          <li class="nav-link"><a href="/tag/%E5%AE%B9%E5%99%A8%E9%95%9C%E5%83%8F/">å®¹å™¨é•œåƒ</a>
          
        
          
          <li class="nav-link"><a href="/category/android/">android</a>
          
        
          
          <li class="nav-link"><a href="/category/%E5%88%A9%E5%99%A8/">åˆ©å™¨</a>
          
        
          
          <li class="nav-link"><a href="/category/%E5%AD%A6%E4%B9%A0-%E6%95%88%E7%8E%87/">å­¦ä¹ &æ•ˆç‡</a>
          
        
          
          <li class="nav-link"><a href="/category/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/">ç¼–ç¨‹è¯­è¨€</a>
          
        
          
          <li class="nav-link"><a href="/category/linux/">linux</a>
          
        
          
          <li class="nav-link"><a href="/category/%E5%86%85%E6%A0%B8/">å†…æ ¸</a>
          
        
          
          <li class="nav-link"><a href="/category/%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/">ä½“ç³»ç»“æ„</a>
          
        
          
          <li class="nav-link"><a href="/category/%E7%94%9F%E6%B4%BB/">ç”Ÿæ´»</a>
          
        
          
          <li class="nav-link"><a href="/category/%E8%99%9A%E6%8B%9F%E5%8C%96/">è™šæ‹ŸåŒ–</a>
          
        
          
          <li class="nav-link"><a href="/category/%E4%BA%91%E5%8E%9F%E7%94%9F/">äº‘åŸç”Ÿ</a>
          
        
          
          <li class="nav-link"><a href="/category/%E6%88%B7%E5%A4%96/">æˆ·å¤–</a>
          
        
          
          <li class="nav-link"><a href="/category/%E8%AE%BA%E6%96%87/">è®ºæ–‡</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
         -->
      </ul>
    </nav>
  </div>
</header>


    <div class="page-content">
        <div class="post">

<div class="post-header-container has-cover" style="background-image: url(https://picturebed.obs.cn-east-2.myhuaweicloud.com/blogPictures/20230320145945.png);">
  <div class="scrim has-cover">
    <header class="post-header">
      <h1 class="title">100ä¸ªRusté—®é¢˜</h1>
      <p class="info">by <strong>FlyFlyPeng</strong></p>
    </header>
  </div>
</div>

<div class="wrapper">



<section class="post-meta">
  <div class="post-date">March 19, 2023</div>
  <div class="post-categories">
  in 
    
    <a href="/category/ç¼–ç¨‹è¯­è¨€">ç¼–ç¨‹è¯­è¨€</a>
    
  
  </div>
</section>

<article class="post-content">
  <h2 id="è¯´æ˜">è¯´æ˜</h2>

<p>è¿™æ˜¯ä¸€ä¸ªæˆ‘è‡ªå·±åœ¨å­¦ä¹ Rustè¯­è¨€ä¸­è®°å½•çš„ä¸€é—ªè€Œè¿‡ä¸æ˜ç™½æƒ³æ·±å…¥æ¢ç©¶æˆ–è€…åœ¨å†™ä»£ç ä¸­ç»å¸¸ä¼šå»æœç´¢æ‰èƒ½è·å–åˆ°ç­”æ¡ˆçš„ä¸€äº›é—®é¢˜ã€‚</p>

<p>è¿™ç¯‡æ–‡ç« å¸Œæœ›å¯ä»¥ç»™å¤§å®¶å½“åšæ˜¯ä¸€ä¸ªFAQæ¥ä½¿ç”¨ï¼Œé‡åˆ°Rustç›¸å…³çš„å›°æƒ‘æ—¶ï¼Œç›´æ¥<code class="language-plaintext highlighter-rouge">Ctrl + F</code>ã€‚</p>

<p><strong>å¸Œæœ›å®ƒæ¯”ChatGPTç»™å‡ºçš„ç­”æ¡ˆæ›´æ¥è¿‘ä½ æƒ³è¦å¾—åˆ°çš„æ ‡å‡†ç­”æ¡ˆï¼</strong></p>

<h2 id="1-rust-examplesæ ·ä¾‹ç¨‹åºå¦‚ä½•åœ¨cargotomlæ–‡ä»¶ä¸­æ·»åŠ ä¾èµ–">1. Rust examplesæ ·ä¾‹ç¨‹åºå¦‚ä½•åœ¨Cargo.tomlæ–‡ä»¶ä¸­æ·»åŠ ä¾èµ–ï¼Ÿ</h2>

<p>ç”±<a href="http://web.mit.edu/rust-lang_v1.25/arch/amd64_ubuntu1404/share/doc/rust/html/cargo/reference/specifying-dependencies.html#development-dependencies">Cargo Book - Development dependencies</a>å¯çŸ¥ï¼Œå¯¹äº<code class="language-plaintext highlighter-rouge">tests, examples, benchmarks</code>ç¨‹åºçš„ä¾èµ–éƒ½ç»Ÿä¸€å¡«å†™åœ¨<code class="language-plaintext highlighter-rouge">Cargo.toml</code>æ–‡ä»¶ä¸­çš„<code class="language-plaintext highlighter-rouge">[dev-dependencies]</code>å°èŠ‚ä¸­ã€‚</p>

<h2 id="2-å¦‚ä½•å°†æ–‡ä»¶ä¸­å†…å®¹è¯»å–åˆ°å†…å­˜çš„bufferä¸­å…¶ä¸­æ–‡ä»¶å†…å®¹é•¿åº¦ä¸ç¡®å®š">2. å¦‚ä½•å°†æ–‡ä»¶ä¸­å†…å®¹è¯»å–åˆ°å†…å­˜çš„Bufferä¸­ï¼Œå…¶ä¸­æ–‡ä»¶å†…å®¹é•¿åº¦ä¸ç¡®å®šï¼Ÿ</h2>

<p>Rustçš„<code class="language-plaintext highlighter-rouge">std::io::Read</code>traitæä¾›äº†å¯¹äºIOæ•°æ®æµè¯»å–çš„æŠ½è±¡ï¼Œå…¶ä¸­æä¾›äº†<code class="language-plaintext highlighter-rouge">read_to_end()</code>å‡½æ•°æ”¯æŒå°†IOæ•°æ®æµè¯»å–åˆ°ä¸€ä¸ª<code class="language-plaintext highlighter-rouge">Vec&lt;u8&gt;</code>çš„å‘é‡ã€‚</p>

<p><a href="https://doc.rust-lang.org/std/io/trait.Read.html#method.read_to_end">read_to_end</a>å‡½æ•°å®šä¹‰å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="language-Rust">fn read_to_end(&amp;mut self, buf: &amp;mut Vec&lt;u8&gt;) -&gt; Result&lt;usize&gt;
</code></pre>

<h2 id="3-rust-ç›¸å…³å­¦ä¹ èµ„æ–™">3. Rust ç›¸å…³å­¦ä¹ èµ„æ–™</h2>

<ul>
  <li><a href="https://doc.rust-lang.org/rust-by-example/std/result/question_mark.html">Rust By Example</a>ï¼šé€šè¿‡ä¸€ä¸ªä¸ªç®€å•çš„ä¾‹å­æ¥å­¦ä¹ Rustï¼Œéå¸¸é€‚åˆç†Ÿæ‚‰Rustçš„è¯­æ³•</li>
  <li><a href="https://doc.rust-lang.org/std/">Rust Stdæ ‡å‡†åº“æ–‡æ¡£</a>ï¼šRust stdæ ‡å‡†åº“çš„æ–‡æ¡£ï¼Œä¸çŸ¥é“æ€ä¹ˆä½¿ç”¨åº“å°±å¯ä»¥æ¥è¿™é‡ŒæŸ¥æŸ¥</li>
  <li><a href="https://cheats.rs/#basic-types">Rust Language Cheat Sheet</a>ï¼šRustè¯­æ³•å’Œç”¨æ³•ç›¸å…³çš„å¿«é€Ÿæ£€ç´¢è¡¨</li>
  <li><a href="https://doc.rust-lang.org/stable/reference/">The Rust Reference</a>ï¼šä»‹ç»Rustè¯­è¨€çš„å†…å­˜æ¨¡å‹ï¼Œå¹¶å‘æ¨¡å‹ï¼Œè¯­æ³•è®¾è®¡è¿™äº›è¯­è¨€å±‚é¢çš„Book</li>
  <li><a href="https://kaisery.github.io/trpl-zh-cn/">Rust ç¨‹åºè®¾è®¡è¯­è¨€ ç®€ä½“ä¸­æ–‡ç‰ˆ</a>ï¼šThe Rust Programming Languageå®˜æ–¹ä¹¦ç±çš„ä¸­è¯‘ç‰ˆ</li>
  <li><a href="https://github.com/rust-lang-cn/rustlings-cn">rustlings</a>ï¼šé¡¹ç›®åŒ…æ‹¬ä¸€äº›è®©ä½ ç†Ÿæ‚‰é˜…è¯»å’Œç¼–å†™ Rust ä»£ç çš„å°ç»ƒä¹ ã€‚è¿™åŒ…æ‹¬é˜…è¯»å’Œå“åº”ç¼–è¯‘å™¨ä¿¡æ¯ï¼</li>
  <li><a href="https://tourofrust.com/00_zh-cn.html">Rust è¯­è¨€ä¹‹æ—…</a>ï¼šé€šè¿‡ä¸€ä¸ªä¸€ç³»åˆ—çš„åœ¨çº¿äº¤äº’æ–¹å¼æ¥ä¸€æ­¥æ­¥åœ°å¼•å¯¼æ–°æ‰‹ç†Ÿæ‚‰Rustè¯­è¨€</li>
  <li><a href="https://github.com/rcore-os/rCore/wiki/os-tutorial-summer-of-code-2020#step-0-%E8%87%AA%E5%AD%A6rust%E7%BC%96%E7%A8%8B%E5%A4%A7%E7%BA%A67%E5%A4%A9">OS Tutorial Summer of Code 2020ï¼šRustç³»ç»Ÿç¼–ç¨‹å…¥é—¨æŒ‡å¯¼</a>ï¼šæ¸…åå¤§å­¦rCoreå›¢é˜Ÿåœ¨os tutorial summer of code 2020é¡¹ç›®ä¸­ç»™å‡ºçš„Rustå¿«é€Ÿå…¥é—¨æŒ‡å¯¼</li>
  <li><a href="https://github.com/google/comprehensive-rust">comprehensive-rust</a>ï¼šGoogle Androidå›¢é˜Ÿæ¨å‡ºçš„Rustå…¥é—¨æ•™ç¨‹</li>
  <li><a href="https://course.rs/about-book.html">Rustè¯­è¨€åœ£ç»(Rust Course)</a>ï¼šå›½å†…Rustå¼€æºçˆ±å¥½è€…å…±åŒç¼–å†™çš„ä¸€æœ¬ä¹¦ï¼Œå…³äºä¹¦ä¸­ä¸ç†è§£çš„éƒ¨åˆ†ï¼Œä¹Ÿæœ‰Commentè®¨è®ºï¼Œä¸ªäººè§‰å¾—è¿™ä¸€ç‚¹å¾ˆæœ‰å¸®åŠ©ï¼Œå¯ä»¥å¸®åŠ©å¤§å®¶è§£ç­”ä¹¦ä¸­é‡åˆ°çš„ç±»ä¼¼çš„é—®é¢˜</li>
</ul>

<h2 id="4-rustä¸­æ–‡ä»¶åå‡½æ•°åæ–‡ä»¶ç›®å½•ç­‰å‘½åçš„ä»£ç è§„èŒƒ">4. Rustä¸­æ–‡ä»¶åã€å‡½æ•°åã€æ–‡ä»¶ç›®å½•ç­‰å‘½åçš„ä»£ç è§„èŒƒï¼Ÿ</h2>

<p><a href="https://rust-coding-guidelines.github.io/rust-coding-guidelines-zh/overview.html">å¼ æ±‰ä¸œè€å¸ˆæ€»ç»“çš„Rustç¼–ç è§„èŒƒ</a></p>

<h2 id="5-rustå¦‚ä½•å®ç°æ•°æ®ç»“æ„åºåˆ—åŒ–æˆjsonæ ¼å¼åŠå…¶ååºåˆ—åŒ–">5. Rustå¦‚ä½•å®ç°æ•°æ®ç»“æ„åºåˆ—åŒ–æˆjsonæ ¼å¼åŠå…¶ååºåˆ—åŒ–ï¼Ÿ</h2>

<h2 id="6-å…¨å±€çš„å¸¸é‡å¦‚ä½•å®šä¹‰">6. å…¨å±€çš„å¸¸é‡å¦‚ä½•å®šä¹‰ï¼Ÿ</h2>

<h2 id="7-lazy_staticå®å’Œstaticé™æ€å˜é‡æœ‰ä»€ä¹ˆåŒºåˆ«">7. lazy_staticï¼å®å’Œstaticé™æ€å˜é‡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h2>

<ul>
  <li><code class="language-plaintext highlighter-rouge">lazy_static!</code>æ˜¯åœ¨ç¨‹åºç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶ï¼ˆè¿è¡Œæ—¶ï¼‰æ‰è¿›è¡Œåˆå§‹åŒ–</li>
  <li><code class="language-plaintext highlighter-rouge">static</code>é™æ€å˜é‡/<code class="language-plaintext highlighter-rouge">const</code>é™æ€å¸¸é‡ï¼Œåˆ™æ˜¯åœ¨ç¨‹åºç¼–è¯‘é˜¶æ®µç”±ç¼–è¯‘å™¨è¿›è¡Œåˆå§‹åŒ–ï¼Œæ‰€ä»¥staticå˜é‡åªèƒ½é€šè¿‡<strong>å¸¸é‡è¡¨è¾¾å¼</strong>æˆ–<strong>æ•°å­¦è¡¨è¾¾å¼</strong></li>
</ul>

<p><strong><code class="language-plaintext highlighter-rouge">lazy_static!</code>å®å¯ä»¥ç”¨åœ¨ä»€ä¹ˆåœºæ™¯ï¼Ÿ</strong></p>

<ul>
  <li>åˆå§‹åŒ–ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„å¯¹è±¡ï¼Œå¹¶ä¸”è¯¥å¯¹è±¡éœ€è¦é€šè¿‡è°ƒç”¨åˆå§‹åŒ–å‡½æ•°è¿›è¡Œæ„é€ æ—¶</li>
  <li>åˆ›å»ºä¸€ä¸ªå…¨å…·çš„Mutexé”ï¼Œä¾›ç¨‹åºä¸­ä¸åŒçº¿ç¨‹ä¹‹é—´å®ç°äº’æ–¥è®¿é—®</li>
</ul>

<p><a href="https://course.rs/advance/global-variable.html">å…¨å±€å˜é‡</a>
<a href="https://www.minazuki.cn/post/blog_os/blog_os-1bt8t9lfea0hv/blog_os-1bu1aakjmdra0/">rust crate: lazy_static</a></p>

<h2 id="8-å®ç°ä¸€ä¸ªç»“æ„ä½“ç›¸å…³æ–¹æ³•">8. å®ç°ä¸€ä¸ªç»“æ„ä½“ç›¸å…³æ–¹æ³•ï¼Ÿ</h2>

<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">impl</span> <span class="o">&lt;</span><span class="k">type</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span> <span class="p">{</span>
	<span class="k">fn</span> <span class="o">&lt;</span><span class="n">func</span><span class="o">-</span><span class="n">signature</span><span class="o">&gt;</span><span class="p">()</span> <span class="p">{</span>
		<span class="o">...</span><span class="err">.</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">impl</span> <span class="o">&lt;</span><span class="k">trait</span><span class="o">&gt;</span> <span class="k">for</span> <span class="o">&lt;</span><span class="k">type</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span> <span class="p">{</span>
	<span class="k">fn</span> <span class="o">&lt;</span><span class="n">func</span><span class="o">-</span><span class="n">define</span><span class="o">-</span><span class="k">in</span><span class="o">-</span><span class="n">the</span><span class="o">-</span><span class="k">trait</span><span class="o">&gt;</span><span class="p">()</span> <span class="p">{</span>
		<span class="o">.....</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="9-anyhowåº“çš„ä½œç”¨">9. anyhowåº“çš„ä½œç”¨ï¼Ÿ</h2>
<p>å¦‚æœæœ‰å¤šä¸ªé”™è¯¯ç±»å‹åœ¨åŒä¸€ä¸ªå‡½æ•°ä¸­éœ€è¦å¤„ç†æ—¶ï¼Œè¿”å›çš„é”™è¯¯ç±»å‹å¿…é¡»æ”¯æŒé€šè¿‡<code class="language-plaintext highlighter-rouge">From</code>traitå®ç°å°†å‡½æ•°ä¸­å¤šç§é”™è¯¯ç±»å‹è½¬æ¢æˆè¿”å›çš„é”™è¯¯ç±»å‹ï¼Œä¾‹å¦‚ï¼š</p>
<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">fn</span> <span class="nf">foo</span><span class="p">()</span> <span class="k">-&gt;</span> <span class="nb">Result</span><span class="o">&lt;</span><span class="p">(),</span> <span class="n">FooError</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">let</span> <span class="n">one</span><span class="p">:</span> <span class="nb">Result</span><span class="o">&lt;</span><span class="p">(),</span> <span class="n">OneError</span><span class="o">&gt;</span> <span class="o">=</span> <span class="nf">fn_one</span><span class="p">();</span>
    <span class="n">one</span><span class="o">?</span><span class="p">;</span>

    <span class="k">let</span> <span class="n">two</span><span class="p">:</span> <span class="nb">Result</span><span class="o">&lt;</span><span class="p">(),</span> <span class="n">TwoError</span><span class="o">&gt;</span> <span class="o">=</span> <span class="nf">fn_two</span><span class="p">();</span>
    <span class="n">two</span><span class="o">?</span><span class="p">;</span>

    <span class="nf">Ok</span><span class="p">(())</span>
<span class="p">}</span>
</code></pre></div></div>
<p>å…¶ä¸­ï¼Œè¿”å›å€¼çš„<code class="language-plaintext highlighter-rouge">FooError</code>é”™è¯¯ç±»å‹ï¼Œå¿…é¡»è¦å®ç°<code class="language-plaintext highlighter-rouge">From&lt;OneError&gt;</code>å’Œ<code class="language-plaintext highlighter-rouge">From&lt;TwoError&gt;</code>ï¼Œè¿™æ ·æ‰èƒ½å®ç°ä¸åŒé”™è¯¯ç±»å‹çš„å½’ä¸€ã€‚é€šå¸¸çš„åšæ³•å°±æ˜¯å°†å¯èƒ½å‡ºç°çš„é”™è¯¯ç±»å‹é€šè¿‡<code class="language-plaintext highlighter-rouge">enum</code>æšä¸¾ç±»å‹å®šä¹‰å‡ºæ¥ï¼Œç„¶åå®ç°<code class="language-plaintext highlighter-rouge">Display</code>ï¼Œ<code class="language-plaintext highlighter-rouge">Debug</code>ï¼Œ<code class="language-plaintext highlighter-rouge">Error</code>ï¼Œ<code class="language-plaintext highlighter-rouge">From&lt;T&gt;</code>è¿™å‡ ä¸ªtraitï¼Œä½†æ˜¯æ‰‹åŠ¨å†™è¿™äº›ä»£ç æ˜¾å¾—éå¸¸æ¯ç‡¥å’Œæ— èŠã€‚</p>

<p>æ‰€ä»¥ï¼Œç¤¾åŒºæœ‰äººå†™äº†<code class="language-plaintext highlighter-rouge">anyhow</code>crateåº“ï¼Œå®ƒæœ¬è´¨å°±æ˜¯å®šä¹‰äº†ä¸€ä¸ª<code class="language-plaintext highlighter-rouge">anyhow::Error</code>çš„ç±»å‹ï¼Œç„¶åé»˜è®¤å®ç°äº†<code class="language-plaintext highlighter-rouge">From&lt;E&gt; where E: Error</code>ï¼Œè¿™æ ·æ‰€æœ‰å®ç°äº†<code class="language-plaintext highlighter-rouge">Error</code>traitçš„æ‰€æœ‰é”™è¯¯ç±»å‹éƒ½å¯ä»¥è½¬æ¢æˆ<code class="language-plaintext highlighter-rouge">anyhow::Error</code>ç±»å‹ã€‚</p>

<p>å¦å¤–ï¼Œå¦‚æœè¦æ„å»ºä¸€ä¸ªé”™è¯¯ç±»å‹å€¼è¿”å›æ—¶ï¼Œå¯ä»¥é€šè¿‡<code class="language-plaintext highlighter-rouge">anyhow!</code>å®è®°æ€§æ„é€ ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">return</span> <span class="nf">Err</span><span class="p">(</span><span class="nd">anyhow!</span><span class="p">(</span><span class="s">"Missing attribute: {}"</span><span class="p">,</span> <span class="n">missing</span><span class="p">));</span>
</code></pre></div></div>

<p><a href="https://www.jmjoy.top/posts/rust%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86%E4%BD%BF%E7%94%A8thiserror+anyhow%E6%9D%A5%E4%BC%98%E9%9B%85%E4%BE%BF%E6%8D%B7%E5%9C%B0%E5%A4%84%E7%90%86%E9%94%99%E8%AF%AF/">ã€Rusté”™è¯¯å¤„ç†ã€‘ä½¿ç”¨<code class="language-plaintext highlighter-rouge">thiserror</code>+<code class="language-plaintext highlighter-rouge">anyhow</code>æ¥ä¼˜é›…ä¾¿æ·åœ°å¤„ç†é”™è¯¯</a>
<a href="https://docs.rs/anyhow/latest/anyhow/">Crate anyhow</a></p>

<h2 id="10-warp-webå¼‚æ­¥å¤„ç†æ¡†æ¶ä¸­mapthenand_thenä¸­å¯¹åº”çš„handleré—­åŒ…å‡½æ•°çš„å‚æ•°æ˜¯å¦‚ä½•æ•è·çš„">10. warp Webå¼‚æ­¥å¤„ç†æ¡†æ¶ä¸­map,then,and_thenä¸­å¯¹åº”çš„handleré—­åŒ…å‡½æ•°çš„å‚æ•°æ˜¯å¦‚ä½•æ•è·çš„ï¼Ÿ</h2>

<p><a href="https://docs.rs/warp/latest/warp/trait.Filter.html#extracting-tuples">Extracting Tuples</a></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>You may notice that several of these filters extract some tuple, often times a tuple of just 1 item! Why?

If a filter extracts aÂ `(String,)`, that simply means that it extracts aÂ `String`. If you were toÂ `map`Â the filter, the argument type would be exactly that, just aÂ `String`.

What is it? Itâ€™s just some type magic that allows for automatic combining and flattening of tuples. Without it, combining two filters together withÂ `and`, where one extractedÂ `()`, and anotherÂ `String`, would mean theÂ `map`Â would be given a single argument ofÂ `((), String,)`, which is just no fun.
</code></pre></div></div>

<p>ä»<code class="language-plaintext highlighter-rouge">Trait warp::Filter</code>ä¸­ä¸Šé¢å…³äºExtractç±»å‹æ•°æ®çš„æè¿°å¯çŸ¥ï¼Œæœ‰çš„<code class="language-plaintext highlighter-rouge">filter</code>åœ¨è¿‡æ»¤è¯·æ±‚çš„æ—¶å€™ï¼Œä¼šå°†è¯·æ±‚ä¸­çš„ä¸€äº›æ•°æ®extractè§£æå‡ºæ¥ï¼Œç„¶åè§£æå‡ºæ¥çš„æ•°æ®ä½œä¸ºè¾“å…¥å‚æ•°ï¼Œä¼ é€’ç»™è¯·æ±‚å¤„ç†çš„handleré—­åŒ…å‡½æ•°ã€‚</p>

<p>ä¾‹å¦‚ï¼Œ<code class="language-plaintext highlighter-rouge">warp::filters::body::json</code>filterå‡½æ•°çš„å®šä¹‰ä¸­ï¼Œå°±Extractå‡ºhttp bodyä¸­çš„jsonå‚æ•°ä¿¡æ¯ï¼š</p>
<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">pub</span> <span class="k">fn</span> <span class="n">json</span><span class="o">&lt;</span><span class="n">T</span><span class="p">:</span> <span class="n">DeserializeOwned</span> <span class="o">+</span> <span class="nb">Send</span><span class="o">&gt;</span><span class="p">(</span>
<span class="p">)</span> <span class="k">-&gt;</span> <span class="k">impl</span> <span class="n">Filter</span><span class="o">&lt;</span><span class="n">Extract</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span><span class="p">,),</span> <span class="n">Error</span> <span class="o">=</span> <span class="n">Rejection</span><span class="o">&gt;</span> <span class="o">+</span> <span class="nb">Copy</span>
</code></pre></div></div>

<p>è€Œ<code class="language-plaintext highlighter-rouge">warp::filters::body::content_length_limit</code>filterå‡½æ•°çš„å®šä¹‰ä¸­ï¼ŒExtractçš„æ•°æ®ç±»å‹ä¸ºç©ºå…ƒç»„<code class="language-plaintext highlighter-rouge">()</code>ï¼Œç©ºå…ƒç»„æ•°æ®ç±»å‹åœ¨åé¢çš„è¯·æ±‚å¤„ç†å‡½æ•°çš„æ•è·å˜é‡ä¸­ä¼šè¢«å¿½ç•¥æ‰ã€‚</p>

<h2 id="11-å¼‚æ­¥ç¼–ç¨‹æ¡†æ¶tokioä¸­å¦‚ä½•æ”¯æŒrwlocké”">11. å¼‚æ­¥ç¼–ç¨‹æ¡†æ¶tokioä¸­å¦‚ä½•æ”¯æŒRWLocké”ï¼Ÿ</h2>

<p>åœ¨WasmEngineæºç ä¸­ï¼ŒFunctionStoreç»“æ„ä½“ä¸­å®šä¹‰äº†ä¸€ä¸ª<code class="language-plaintext highlighter-rouge">Arc&lt;RwLock&lt;HashMap&lt;String, FunctionEntry&gt;&gt;&gt;</code>ç±»å‹çš„æˆå‘˜ï¼Œå…¶ä¸­çš„<code class="language-plaintext highlighter-rouge">RwLock</code>æ˜¯stdæ ‡å‡†åº“ä¸­çš„ä¸€ä¸ª<code class="language-plaintext highlighter-rouge">std::sync::RwLock</code>è¯»å†™é”ï¼Œä½†æ˜¯åŸºäºtokioçš„å¼‚æ­¥ç¼–ç¨‹æ¡†æ¶ä¸­ï¼Œç¼–è¯‘ä»£ç æ—¶rustcç¼–è¯‘å™¨å´æç¤ºå¦‚ä¸‹çš„é”™è¯¯ä¿¡æ¯ï¼š</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>future cannot be sent between threads safely  
within <span class="sb">`</span>impl Future&lt;Output <span class="o">=</span> Result&lt;Opaque<span class="o">(</span>DefId<span class="o">(</span>0:578 ~ wasm_engine[2ad7]::handlers::deploy_function::<span class="o">{</span>opaque#0<span class="o">}</span>::<span class="o">{</span>opaque#0<span class="o">})</span>, <span class="o">[])</span>, Rejection&gt;&gt;<span class="sb">`</span>, the trait <span class="sb">`</span>Send<span class="sb">`</span> is not implemented <span class="k">for</span> <span class="sb">`</span>std::sync::RwLockWriteGuard&lt;<span class="s1">'_, HashMap&lt;std::string::String, FunctionEntry&gt;&gt;`
</span></code></pre></div></div>

<p>ä¸Šé¢çš„é”™è¯¯æç¤ºä¿¡æ¯ä¸­è¯´åˆ°<code class="language-plaintext highlighter-rouge">std::sync::RwLockWriteGuard</code>æ²¡æœ‰å®ç°<code class="language-plaintext highlighter-rouge">Send</code> traitï¼Œå¯¼è‡´æ— æ³•å®ç°è¯»å†™é”çš„æ‰€æœ‰æƒè·¨çº¿ç¨‹å®‰å…¨ä¼ é€’ã€‚</p>

<p>è¡¥å……ï¼š<code class="language-plaintext highlighter-rouge">Send</code>traitæ˜¯Rustä¸­å®šä¹‰æ ‡è®°å‹traitï¼ˆmark traitï¼‰ï¼Œå®ƒæ²¡æœ‰å®šä¹‰ä»»ä½•å‡½æ•°è¡Œä¸ºï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯å¦‚æœä¸€ä¸ªæ•°æ®ç±»å‹å®ç°äº†<code class="language-plaintext highlighter-rouge">Send</code> traitï¼Œé‚£ä¹ˆè¯¥ç±»å‹å€¼çš„æ‰€æœ‰æƒå¯ä»¥å®‰å…¨åˆ°ä»ä¸€ä¸ªçº¿ç¨‹moveåˆ°å¦å¤–ä¸€ä¸ªçº¿ç¨‹ä¸­ã€‚</p>

<p><code class="language-plaintext highlighter-rouge">std::sync::RwLockWriteGuard</code>ç±»å‹çš„å®šä¹‰å¦‚ä¸‹æ‰€ç¤ºï¼Œå¯ä»¥çœ‹åˆ°å®ƒçš„ç¡®æ²¡æœ‰å®ç°<code class="language-plaintext highlighter-rouge">Send</code> traitï¼Œæ‰€ä»¥å°±æ— æ³•å®ç°è·¨çº¿ç¨‹çš„æ‰€æœ‰æƒå®‰å…¨ç§»åŠ¨ã€‚</p>
<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">#[stable(feature</span> <span class="nd">=</span> <span class="s">"rust1"</span><span class="nd">,</span> <span class="nd">since</span> <span class="nd">=</span> <span class="s">"1.0.0"</span><span class="nd">)]</span>

<span class="k">impl</span><span class="o">&lt;</span><span class="n">T</span><span class="p">:</span> <span class="o">?</span><span class="nb">Sized</span><span class="o">&gt;</span> <span class="o">!</span><span class="nb">Send</span> <span class="k">for</span> <span class="n">RwLockWriteGuard</span><span class="o">&lt;</span><span class="nv">'_</span><span class="p">,</span> <span class="n">T</span><span class="o">&gt;</span> <span class="p">{}</span>

  

<span class="nd">#[stable(feature</span> <span class="nd">=</span> <span class="s">"rwlock_guard_sync"</span><span class="nd">,</span> <span class="nd">since</span> <span class="nd">=</span> <span class="s">"1.23.0"</span><span class="nd">)]</span>

<span class="k">unsafe</span> <span class="k">impl</span><span class="o">&lt;</span><span class="n">T</span><span class="p">:</span> <span class="o">?</span><span class="nb">Sized</span> <span class="o">+</span> <span class="nb">Sync</span><span class="o">&gt;</span> <span class="nb">Sync</span> <span class="k">for</span> <span class="n">RwLockWriteGuard</span><span class="o">&lt;</span><span class="nv">'_</span><span class="p">,</span> <span class="n">T</span><span class="o">&gt;</span> <span class="p">{}</span>
</code></pre></div></div>

<p>ä½†æ˜¯tokio crateä¸­æä¾›äº†å¯ä»¥åœ¨å¼‚æ­¥ç¼–ç¨‹æ¡†æ¶ä¸­ä½¿ç”¨çš„<a href="https://docs.rs/tokio/1.12.0/tokio/sync/struct.RwLock.html">tokio::sync::RwLock</a>è¯»å†™é”ï¼Œå®ƒçš„åŠŸèƒ½å’Œæ¥å£ä¸stdä¸­çš„<code class="language-plaintext highlighter-rouge">std::sync::RwLock</code>ä¿æŒä¸€è‡´ã€‚</p>

<h2 id="12-tracing_subscriberå¦‚ä½•æ§åˆ¶ä¸æ”¶é›†åº•å±‚ä¾èµ–åº“è¾“å‡ºçš„trace-dataä¿¡æ¯">12. tracing_subscriberå¦‚ä½•æ§åˆ¶ä¸æ”¶é›†åº•å±‚ä¾èµ–åº“è¾“å‡ºçš„trace dataä¿¡æ¯ï¼Ÿ</h2>

<p>åœ¨è°ƒè¯•WasmEngineä»£ç çš„æ—¶å€™ï¼Œå‘ç°å¦‚æœé€šè¿‡<code class="language-plaintext highlighter-rouge">RUST_LOG</code>ç¯å¢ƒå˜é‡è®¾ç½®æ—¥å¿—çº§åˆ«ä¸º<code class="language-plaintext highlighter-rouge">info</code>çš„æ—¶å€™ï¼Œä¼šå°†ä¾èµ–åº“ä¸­çš„infoçº§åˆ«çš„æ—¥å¿—ä¹Ÿä¸€èµ·è¾“å‡ºåˆ°æ§åˆ¶å°ï¼Œä¸€ç›´åœ¨åˆ·å±ï¼Œå¯¼è‡´WasmEngineä¸­è‡ªå·±æ·»åŠ çš„æ—¥å¿—ä¿¡æ¯æ— æ³•çœ‹åˆ°ã€‚</p>

<p>é—®é¢˜çš„æ ¹å› ï¼šå¦‚æœæ˜¯å…¨å±€çš„global subscriberï¼Œå®ƒä¼šå°†ç¨‹åºåŠå…¶ä¾èµ–åº“æ‰€è¾“å‡ºçš„æ‰€æœ‰eventå’Œspanäº‹ä»¶éƒ½æ•è·å¹¶è¾“å‡ºå‡ºæ¥ã€‚</p>

<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šè§£å†³çš„æ–¹æ³•ä¹Ÿéå¸¸ç®€å•ï¼Œå°±æ˜¯åœ¨<code class="language-plaintext highlighter-rouge">subscriber</code>ä¸Šæ·»åŠ filterè¿‡æ»¤å™¨ï¼Œè¿™é‡Œä½¿ç”¨äº†ç³»ç»Ÿé»˜è®¤çš„<code class="language-plaintext highlighter-rouge">EnvFilter::from_default_env()</code> filterï¼Œå®ƒä¼šä»ç³»ç»Ÿç¯å¢ƒå˜é‡<code class="language-plaintext highlighter-rouge">RUST_LOG</code>ä¸­è¯»å–è¿‡æ»¤å™¨çš„é…ç½®ä¿¡æ¯ï¼Œç„¶ååº”ç”¨åˆ°subscriberä¸Šã€‚</p>

<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">tracing_subscriber</span><span class="p">::</span><span class="nf">fmt</span><span class="p">()</span>
	<span class="nf">.with_env_filter</span><span class="p">(</span><span class="nn">EnvFilter</span><span class="p">::</span><span class="nf">from_default_env</span><span class="p">())</span>
	<span class="nf">.try_init</span><span class="p">()</span><span class="o">?</span><span class="p">;</span>
</code></pre></div></div>

<p>æ‰€ä»¥ï¼Œåœ¨è¿è¡Œç¨‹åºçš„æ—¶å€™ï¼Œéœ€è¦é¦–å…ˆè¿›è¡Œ<code class="language-plaintext highlighter-rouge">RUST_LOG</code>ç¯å¢ƒå˜é‡çš„èµ‹å€¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">RUST_LOG</span><span class="o">=</span><span class="nv">wasm_engine</span><span class="o">=</span>info
</code></pre></div></div>

<blockquote>
  <p>ğŸ“¢æ³¨æ„ï¼šè¿™é‡Œwasm_engineå€¼çš„è¡¨ç¤ºçš„å«ä¹‰æ˜¯éœ€è¦è¾“å‡ºé‚£ä¸ªcrateçš„æ—¥å¿—ä¿¡æ¯ï¼Œinfoè¡¨ç¤ºè¾“å‡ºæ—¥å¿—çš„æœ€å°çº§åˆ«ã€‚
è¿™é‡Œæœ‰ä¸€ä¸ªå‘å°±æ˜¯æˆ‘çš„ä»£ç åº“çš„åç§°æ˜¯<code class="language-plaintext highlighter-rouge">wasm-engine</code>ï¼Œé‡Œé¢åŒ…å«äº†ä¸€ä¸ª<code class="language-plaintext highlighter-rouge">-</code>ä¸­åˆ’çº¿ï¼Œä½†æ˜¯åœ¨tracingç³»ç»Ÿæ”¶é›†æ•°æ®æ—¶ï¼Œå®ƒé»˜è®¤ä¼šå°†<code class="language-plaintext highlighter-rouge">wasm-engine</code>ä»£ç åº“åç§°ä¸­çš„<strong>ä¸­åˆ’çº¿è½¬æ¢æˆä¸‹åˆ’çº¿å½¢å¼</strong> <code class="language-plaintext highlighter-rouge">wasm_engine</code>ã€‚</p>
</blockquote>

<h2 id="13-rustä¸­å¦‚ä½•åœ¨è¿è¡Œæ—¶è¾“å‡ºå˜é‡çš„ç±»å‹">13. Rustä¸­å¦‚ä½•åœ¨è¿è¡Œæ—¶è¾“å‡ºå˜é‡çš„ç±»å‹ï¼Ÿ</h2>

<p>Rustä¸­æ²¡æœ‰ç±»ä¼¼Cè¯­è¨€ä¸­<code class="language-plaintext highlighter-rouge">typeof</code>å‡½æ•°è·å–å˜é‡æ•°æ®ç±»å‹çš„å‡½æ•°ï¼Œéœ€è¦é€šè¿‡æ³›å‹çš„æ–¹å¼è·å–åˆ°å˜é‡çš„ç±»å‹ï¼Œç„¶åè°ƒç”¨<code class="language-plaintext highlighter-rouge">std::any::type_name</code> è·å–åˆ°ç±»å‹çš„åç§°ï¼Œä¾‹å­å¦‚ä¸‹ï¼š</p>
<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">fn</span> <span class="n">print_type_of</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">_</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="p">{</span>
    <span class="nd">println!</span><span class="p">(</span><span class="s">"{}"</span><span class="p">,</span> <span class="nn">std</span><span class="p">::</span><span class="nn">any</span><span class="p">::</span><span class="nn">type_name</span><span class="p">::</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">())</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">let</span> <span class="n">s</span> <span class="o">=</span> <span class="s">"Hello"</span><span class="p">;</span>
    <span class="k">let</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">42</span><span class="p">;</span>

    <span class="nf">print_type_of</span><span class="p">(</span><span class="n">s</span><span class="p">);</span> <span class="c1">// &amp;str</span>
    <span class="nf">print_type_of</span><span class="p">(</span><span class="n">i</span><span class="p">);</span> <span class="c1">// i32</span>
    <span class="nf">print_type_of</span><span class="p">(</span><span class="n">main</span><span class="p">);</span> <span class="c1">// playground::main</span>
    <span class="nf">print_type_of</span><span class="p">(</span><span class="nn">print_type_of</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">i32</span><span class="o">&gt;</span><span class="p">);</span> <span class="c1">// playground::print_type_of&lt;i32&gt;</span>
    <span class="nf">print_type_of</span><span class="p">(||</span> <span class="s">"Hi!"</span> <span class="p">);</span> <span class="c1">// playground::main::</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="14-å¦‚ä½•åœ¨å‡½æ•°ä¹‹é—´ä¼ é€’å­—ç¬¦ä¸²">14. å¦‚ä½•åœ¨å‡½æ•°ä¹‹é—´ä¼ é€’å­—ç¬¦ä¸²ï¼Ÿ</h2>

<p>äº†è§£<code class="language-plaintext highlighter-rouge">str</code>, <code class="language-plaintext highlighter-rouge">&amp;str</code>, <code class="language-plaintext highlighter-rouge">String</code>ä¸‰ç§ä¸åŒå­—ç¬¦ä¸²ç›¸å…³ç±»å‹åœ¨å†…å­˜ä¸­çš„å­˜å‚¨ç»“æ„ä¹‹é—´å·®å¼‚ï¼Œå°±å¯ä»¥çŸ¥é“åœ¨ä¸åŒå‡½æ•°ä¹‹é—´ï¼Œ<strong>ä¼ é€’å­—ç¬¦ä¸²å†…å®¹æœ€å¥½çš„æ–¹å¼å°±æ˜¯é€šè¿‡<code class="language-plaintext highlighter-rouge">&amp;str</code>ç±»å‹ï¼ˆå­—ç¬¦ä¸²åˆ‡ç‰‡å¼•ç”¨ï¼‰ï¼Œè¿™ç§æ–¹å¼çš„å¥½å¤„å°±æ˜¯å­—ç¬¦ä¸²çš„æ‰€æœ‰æƒä¸ä¼šè¢«è½¬ç§»ã€‚</strong></p>

<p>ä¾‹å­ï¼š</p>
<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">fn</span> <span class="nf">say_it_loud</span><span class="p">(</span><span class="n">msg</span><span class="p">:</span><span class="o">&amp;</span><span class="nb">str</span><span class="p">){</span>
    <span class="nd">println!</span><span class="p">(</span><span class="s">"{}ï¼ï¼ï¼"</span><span class="p">,</span><span class="n">msg</span><span class="nf">.to_string</span><span class="p">()</span><span class="nf">.to_uppercase</span><span class="p">());</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// say_it_loud can borrow &amp;'static str as a &amp;str</span>
    <span class="nf">say_it_loud</span><span class="p">(</span><span class="s">"ä½ å¥½"</span><span class="p">);</span>
    <span class="c1">// say_it_loud can also borrow String as a &amp;str</span>
    <span class="nf">say_it_loud</span><span class="p">(</span><span class="o">&amp;</span><span class="nn">String</span><span class="p">::</span><span class="nf">from</span><span class="p">(</span><span class="s">"å†è§"</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="15-å¼•ç”¨referenceå’ŒæŒ‡é’ˆraw-pointerçš„åŒºåˆ«æ˜¯ä»€ä¹ˆ">15. å¼•ç”¨ï¼ˆReferenceï¼‰å’ŒæŒ‡é’ˆï¼ˆRaw Pointerï¼‰çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h2>

<p>å¼•ç”¨çš„å®šä¹‰ï¼š</p>
<blockquote>
  <p>å¼•ç”¨æœ¬è´¨ä¸Šåªæ˜¯<strong>è¡¨ç¤ºå†…å­˜ä¸­æŸäº›å­—èŠ‚èµ·å§‹ä½ç½®çš„æ•°å­—</strong>ï¼Œå®ƒå”¯ä¸€çš„ç›®çš„å°±æ˜¯æ ‡è¯†ç‰¹å®šç±»å‹çš„æ•°æ®å­˜å‚¨åœ¨ä½•å¤„ã€‚</p>
</blockquote>

<p>æŒ‡é’ˆçš„å®šä¹‰ï¼š</p>
<blockquote>
  <p><strong>æŒ‡é’ˆï¼ˆRaw Pointerï¼‰</strong>åƒæ•°å­—ä¸€æ ·ï¼Œæ ‡è¯†ç‰¹å®šç±»å‹æ•°æ®åœ¨å†…å­˜ä¸­èµ·å§‹ä½ç½®ï¼Œå®ƒå¯ä»¥ä¸å—é™åˆ¶åœ°å¤åˆ¶å’Œä¼ é€’ï¼Œä½†æ˜¯<strong>Rust ä¸ä¿è¯å®ƒæŒ‡å‘çš„å†…å­˜ä½ç½®çš„æœ‰æ•ˆæ€§</strong>ã€‚</p>
</blockquote>

<p>Rustä¸­æœ‰ä¸¤ç§æŒ‡é’ˆç±»å‹ï¼š</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">*const T</code>ï¼šå¸¸é‡æŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆæ‰€æŒ‡å‘çš„æ˜¯ç±»å‹æ°¸è¿œæ˜¯T<strong>å¹¶ä¸ä¼šæ”¹å˜çš„æ•°æ®</strong></li>
  <li><code class="language-plaintext highlighter-rouge">*mut T</code>ï¼šå¯å˜æŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆæ‰€æŒ‡å‘çš„æ˜¯æ•°æ®ç±»å‹æ˜¯Tï¼Œ<strong>ä½†æ˜¯å¯ä»¥ä¿®æ”¹è¿™ä¸ªæ•°æ®çš„å€¼</strong></li>
</ul>

<blockquote>
  <p>æ³¨æ„ï¼šRustä¸­è£¸æŒ‡é’ˆçš„æ“ä½œéœ€è¦åœ¨unsafeä»£ç å—ä¸­æ‰§è¡Œ</p>
</blockquote>

<p>åœ¨Rustä¸­æŒ‡é’ˆç±»å‹æ˜¯ç”¨<code class="language-plaintext highlighter-rouge">usize</code>æ¥è¡¨ç¤ºï¼Œå¤§å°ä¸ºæ˜¯4å­—èŠ‚ã€‚</p>

<p>å¼•ç”¨ä¸ç®€å•çš„æŒ‡é’ˆï¼ˆè¿™é‡Œå¯ä»¥ç†è§£ä¸ºå°±æ˜¯ä¸€ä¸ª64bitçš„æ•°å­—ï¼‰æœ€é‡è¦çš„åŒºåˆ«åœ¨äºï¼š<strong>Rust çš„ç¼–è¯‘å™¨å°†éªŒè¯å¼•ç”¨è‡ªèº«çš„ç”Ÿå‘½å‘¨æœŸä¸ä¼šè¶…è¿‡å®ƒæŒ‡å‘çš„å†…å®¹ï¼Œå¦åˆ™æˆ‘ä»¬åœ¨ä½¿ç”¨å®ƒæ—¶ä¼šå‡ºé”™ï¼ï¼ˆè¿™è§£å†³äº†C/C++ä¸­ç»å¸¸é‡åˆ°çš„æ‚¬å‚æŒ‡é’ˆé—®é¢˜ï¼‰</strong>ã€‚</p>

<h2 id="16-ä¸ºä»€ä¹ˆå¼•ç”¨å˜é‡é€šè¿‡è¿ç®—ç¬¦è®¿é—®æ‰€å¼•ç”¨ç±»å‹ä¸­çš„å­—æ®µå’Œæ–¹æ³•æ—¶éœ€è¦åŠ ä¸Šè§£å¼•ç”¨ç¬¦å·">16. ä¸ºä»€ä¹ˆå¼•ç”¨å˜é‡é€šè¿‡<code class="language-plaintext highlighter-rouge">.</code>è¿ç®—ç¬¦è®¿é—®æ‰€å¼•ç”¨ç±»å‹ä¸­çš„å­—æ®µå’Œæ–¹æ³•æ—¶éœ€è¦åŠ ä¸Š<code class="language-plaintext highlighter-rouge">*</code>è§£å¼•ç”¨ç¬¦å·ï¼Ÿ</h2>

<p>ä¸‹é¢æ˜¯ä¸€ä¸ªå¸¸è§çš„é€šè¿‡<code class="language-plaintext highlighter-rouge">.</code>è¿ç®—ç¬¦è®¿é—®å¼•ç”¨çš„å­—æ®µå’Œæ–¹æ³•çš„ä¾‹å­ï¼š</p>
<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">let</span> <span class="n">f</span> <span class="o">=</span> <span class="n">Foo</span> <span class="p">{</span> <span class="n">value</span><span class="p">:</span> <span class="mi">42</span> <span class="p">};</span>
<span class="k">let</span> <span class="n">ref_ref_ref_f</span> <span class="o">=</span> <span class="o">&amp;&amp;&amp;</span><span class="n">f</span><span class="p">;</span>
<span class="nd">println!</span><span class="p">(</span><span class="s">"{}"</span><span class="p">,</span> <span class="n">ref_ref_ref_f</span><span class="py">.value</span><span class="p">);</span>
</code></pre></div></div>

<p>ä¸ºä»€ä¹ˆä¸Šé¢æ˜¯é€šè¿‡<code class="language-plaintext highlighter-rouge">ref_ref_ref_f.value</code>æ–¹å¼è®¿é—®valueå­—æ®µï¼Œè€Œä¸æ˜¯<code class="language-plaintext highlighter-rouge">(***ref_ref_ref_f).value</code>çš„æ–¹å¼å‘¢ï¼Œå› ä¸º<code class="language-plaintext highlighter-rouge">.</code>è¿ç®—ç¬¦ä¼šè‡ªåŠ¨åšä¸€äº›è§£å¼•ç”¨çš„æ“ä½œï¼Œæœ€åä¸€è¡Œç”±ç¼–è¯‘å™¨è‡ªåŠ¨è½¬æ¢ä¸ºä»¥ä¸‹å†…å®¹ï¼š</p>
<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">println!</span><span class="p">(</span><span class="s">"{}"</span><span class="p">,</span> <span class="p">(</span><span class="o">***</span><span class="n">ref_ref_ref_f</span><span class="p">)</span><span class="py">.value</span><span class="p">);</span>
</code></pre></div></div>

<h2 id="17-æ™ºèƒ½æŒ‡é’ˆå¸¸ç”¨çš„ä¸€äº›ç»„åˆä½¿ç”¨æ–¹å¼åŒºåˆ«æ˜¯ä»€ä¹ˆ">17. æ™ºèƒ½æŒ‡é’ˆå¸¸ç”¨çš„ä¸€äº›ç»„åˆä½¿ç”¨æ–¹å¼åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h2>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Rc&lt;Vec&lt;Foo&gt;&gt;</code>ï¼šå…è®¸å…‹éš†å¤šä¸ªå¯ä»¥<strong>å€Ÿç”¨å †ä¸Šä¸å¯å˜æ•°æ®ç»“æ„</strong>çš„<strong>ç›¸åŒvectorå¯¹è±¡</strong>çš„æ™ºèƒ½æŒ‡é’ˆ</li>
  <li><code class="language-plaintext highlighter-rouge">Rc&lt;RefCell&lt;Foo&gt;&gt;</code>ï¼šå…è®¸å¤šä¸ªæ™ºèƒ½æŒ‡é’ˆé€šè¿‡<strong>å¯å˜æˆ–ä¸å¯å˜ï¼ˆéœ€è¦é€šè¿‡<code class="language-plaintext highlighter-rouge">borrow_mut()å’Œborrow()æ–¹æ³•å®ç°</code>ï¼‰çš„æ–¹å¼å€Ÿç”¨å †ä¸Šçš„ç›¸åŒFooç±»å‹å¯¹è±¡</strong></li>
  <li><code class="language-plaintext highlighter-rouge">Arc&lt;Mutex&lt;Foo&gt;&gt;</code>ï¼šå…è®¸å¤šä¸ªæ™ºèƒ½æŒ‡é’ˆ<strong>ä»¥CPUçº¿ç¨‹ç‹¬å æ–¹å¼é”å®šä¸´æ—¶å¯å˜/ä¸å¯å˜å€Ÿç”¨çš„èƒ½åŠ›</strong></li>
</ul>

<p>è¿™é‡Œéœ€è¦è¡¥å……ä¸€äº›å…³äº<strong>å†…éƒ¨å¯å˜æ€§ vs å¤–éƒ¨å¯å˜æ€§</strong>çš„å·®å¼‚ï¼š</p>
<ul>
  <li><strong>å¤–éƒ¨å¯å˜æ€§</strong>ï¼šå½“æˆ‘ä»¬ä½¿ç”¨<code class="language-plaintext highlighter-rouge">let mut</code>æ˜¾ç¤ºåœ°å£°æ˜ä¸€ä¸ªå¯å˜çš„å€¼ï¼Œæˆ–è€…ç”¨<code class="language-plaintext highlighter-rouge">&amp;mut</code>å£°æ˜ä¸€ä¸ªå¯å˜å¼•ç”¨æ—¶ï¼Œç¼–è¯‘å™¨å¯ä»¥åœ¨ç¼–è¯‘å™¨é˜¶æ®µæ‰§è¡Œä¸¥æ ¼çš„æ£€æŸ¥ï¼Œä¿è¯åªæœ‰å¯å˜å€¼æˆ–è€…å¯å˜çš„å¼•ç”¨ï¼Œæ‰èƒ½ä¿®æ”¹å€¼çš„å†…éƒ¨æ•°æ®ï¼Œè¿™ç§å¯å˜æ€§è¢«ç§°ä¸º<strong>å¤–éƒ¨å¯å˜æ€§</strong>ï¼Œé€šè¿‡<code class="language-plaintext highlighter-rouge">mut</code>å…³é”®å­—å£°æ˜ã€‚</li>
  <li><strong>å†…éƒ¨å¯å˜æ€§</strong>ï¼šåœ¨ç¼–è¯‘å™¨çš„è§’åº¦ï¼Œå€¼æ˜¯åªè¯»çš„ï¼Œä½†æ˜¯åœ¨è¿è¡Œæ—¶ï¼Œè¿™ä¸ªå€¼å¯ä»¥å¾—åˆ°å¯å˜çš„å€Ÿç”¨ï¼Œä»è€Œä¿®æ”¹å†…éƒ¨çš„æ•°æ®ï¼Œè¿™ä¸ªå°±æ˜¯<code class="language-plaintext highlighter-rouge">RefCell</code>å’Œ<code class="language-plaintext highlighter-rouge">Mutex</code>çš„ç”¨æ­¦ä¹‹åœ°ã€‚</li>
</ul>

<h2 id="18--å¯¼å…¥crateå†…å¸¸ç”¨çš„preludeå…³é”®å­—å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆ">18.  å¯¼å…¥crateå†…å¸¸ç”¨çš„<code class="language-plaintext highlighter-rouge">prelude</code>å…³é”®å­—å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</h2>

<p>Ruståœ¨å…¶æ ‡å‡†åº“ä¸­é™„å¸¦äº†è®¸å¤šä¸œè¥¿ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ¯æ¬¡ä½¿ç”¨åˆ°ä¸€ä¸ªæ¨¡å—å°±éœ€è¦æ‰‹åŠ¨å¯¼å…¥ä¸€ä¸ªï¼Œé‚£ä»£ç å°±ä¼šæ˜¾å¾—éå¸¸å†—é•¿ï¼›å¦‚æœå¯¼å…¥åº“ä¸­æ‰€æœ‰çš„æ¨¡å—ï¼Œä½†æ˜¯å…¶ä¸­ä¸€äº›æ¨¡å—æ˜¯ç¨‹åºä¸­ä»æœªä½¿ç”¨åˆ°çš„ï¼Œè¿™å°±å›å¯¼è‡´ä»£ç ç¼–è¯‘æ—¶å¸¦å…¥è®¸å¤šå†—ä½™ä»£ç ï¼›æ‰€ä»¥ï¼Œæœ€å¥½æ˜¯èƒ½å¤Ÿæä¾›ä¸€ç§æœºåˆ¶ï¼Œè‡ªåŠ¨æ ¹æ®ç¨‹åºä¸­ä½¿ç”¨åˆ°çš„æ¨¡å—ä¿¡æ¯ï¼Œè‡ªåŠ¨å¯¼å…¥ä¾èµ–çš„æ¨¡å—ã€‚</p>

<p><code class="language-plaintext highlighter-rouge">prelude</code>å°±æ˜¯Rustæä¾›çš„æ ¹æ®ç¨‹åºä¸­ä½¿ç”¨åˆ°çš„æ¨¡å—ä¿¡æ¯ï¼Œè‡ªåŠ¨å¯¼å…¥æ‰€ä½¿ç”¨æ¨¡å—çš„åˆ—è¡¨ã€‚</p>

<h2 id="19-rusté¡¹ç›®ä¸­å¦‚ä½•å¼•ç”¨å…¶ä»–é¡¹ç›®ä¸­éå‘å¸ƒåˆ°cratesioçš„crateåŒ…">19. Rusté¡¹ç›®ä¸­å¦‚ä½•å¼•ç”¨å…¶ä»–é¡¹ç›®ä¸­éå‘å¸ƒåˆ°crates.ioçš„crateåŒ…ï¼Ÿ</h2>

<p><strong>é—®é¢˜æè¿°</strong>ï¼šä¾‹å¦‚ï¼Œæˆ‘æƒ³åœ¨è‡ªå·±çš„Rusté¡¹ç›®ä¸­å¼•ç”¨åˆ°<a href="https://github.com/cloud-hypervisor/cloud-hypervisor.git">cloud-hypervisor</a>é¡¹ç›®ä¸­çš„<code class="language-plaintext highlighter-rouge">api_client</code>è¿™ä¸ªlibç±»å‹çš„crateï¼Œé‚£ä¹ˆåœ¨æˆ‘çš„é¡¹ç›®çš„<code class="language-plaintext highlighter-rouge">Cargo.toml</code>ä¸­åº”è¯¥æ€ä¹ˆå¼•ç”¨åˆ°è¿™ä¸ªdepä¾èµ–åŒ…å‘¢ï¼Ÿ</p>

<p><strong>è§£å†³æ–¹æ³•</strong>ï¼šå¦‚æœcrateæ‰€åœ¨çš„é¡¹ç›®æ˜¯é€šè¿‡<code class="language-plaintext highlighter-rouge">git</code>å·¥å…·è¿›è¡Œç®¡ç†çš„ï¼Œé‚£ä¹ˆå°±å¯ä»¥åœ¨<code class="language-plaintext highlighter-rouge">Cargo.toml</code>æ–‡ä»¶ä¸­ï¼Œé€šè¿‡<code class="language-plaintext highlighter-rouge">git</code>ä½œä¸ºå…³é”®å­—æ¥æ¥æŒ‡å®šcrateä¾èµ–ï¼Œä¾‹å¦‚ï¼š</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>dependencies] api_client <span class="o">=</span> <span class="o">{</span> git <span class="o">=</span> <span class="s2">"https://github.com/cloud-hypervisor/cloud-hypervisor"</span> branch <span class="o">=</span> <span class="s2">"main"</span><span class="o">}</span>
</code></pre></div></div>

<p>å½“Cargoå·¥å…·æ£€æµ‹åˆ°<code class="language-plaintext highlighter-rouge">Cargo.toml</code>æ–‡ä»¶ä¸­å­˜åœ¨é€šè¿‡<code class="language-plaintext highlighter-rouge">git</code>å…³é”®å­—æŒ‡å®šä¾èµ–crateåŒ…æ—¶ï¼Œå°±ä¼šè°ƒç”¨<code class="language-plaintext highlighter-rouge">git</code>å‘½ä»¤è¡Œå·¥å…·å°†æŒ‡å®šURLçš„git repoä»“åº“ä¸‹è½½åˆ°æœ¬åœ°ã€‚</p>

<pre><code class="language-ad-hint">æ³¨æ„ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼š**é¡¹ç›®ä¾èµ–çš„crateæ˜¯ä¸€ä¸ªå¤§å‹Rusté¡¹ç›®[workspace]ä¸­çš„ä¸€ä¸ªmember**ï¼Œ
ï¼Œè€Œæˆ‘ä»¬åªæƒ³å¼•ç”¨è¿™ä¸€ä¸ªcrateï¼Œé‚£ä¹ˆè¿™ä¸ªä¾èµ–è¯¥æ€ä¹ˆå†™å‘¢ï¼Ÿ

ä¸Šé¢çš„`api_client`å°±æ˜¯è¿™æ ·ä¸€ä¸ªä¾‹å­ï¼Œåªéœ€è¦ä¸¤æ­¥ï¼š
1. ä¿æŒä¾èµ–çš„crateåç§°å’Œä¾èµ–çš„Rusté¡¹ç›®ä¸­çš„**åç§°ä¸€è‡´**
2. `git`å…³é”®å­—åé¢çš„é“¾æ¥**åªéœ€è¦å¡«å†™æ•´ä¸ªRusté¡¹ç›®çš„gitåœ°å€ï¼Œä¸å¿…å¡«å†™åˆ°crateæ‰€åœ¨Cargo.tomlçš„è·¯å¾„**
</code></pre>

<p>å¼€å‘è€…è¿˜å¯ä»¥æŒ‡å®šä½¿ç”¨crateåŒ…æ‰€ä¾èµ–çš„git repoä»“åº“çš„åˆ†æ”¯æˆ–ç‰¹å®šçš„commitidï¼ŒæŒ‡å®šåˆ†æ”¯ä½¿ç”¨<code class="language-plaintext highlighter-rouge">branch</code>å…³é”®å­—æè¿°ï¼ŒæŒ‡å®šcommitidä½¿ç”¨<code class="language-plaintext highlighter-rouge">rev</code>å…³é”®å­—æ¥æè¿°ï¼Œä¾‹å¦‚ï¼š</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>dependencies] regex <span class="o">=</span> <span class="o">{</span> git <span class="o">=</span> <span class="s2">"https://github.com/rust-lang/regex"</span>, branch <span class="o">=</span> <span class="s2">"next"</span> <span class="o">}</span>
</code></pre></div></div>

<p>å‚è€ƒèµ„æ–™ï¼š<a href="https://doc.rust-lang.org/cargo/reference/specifying-dependencies.html#specifying-dependencies-from-git-repositories">Cargo Book - Specifying dependencies from git repositories</a></p>

<h2 id="20-åœ¨linuxç³»ç»Ÿä¸­å¦‚ä½•ç®¡ç†ä¸åŒçš„rustç‰ˆæœ¬">20. åœ¨Linuxç³»ç»Ÿä¸­å¦‚ä½•ç®¡ç†ä¸åŒçš„Rustç‰ˆæœ¬ï¼Ÿ</h2>

<p><strong>æŸ¥çœ‹å½“å‰Rustå„ä¸ªç‰ˆæœ¬ä¿¡æ¯</strong>
å¯ä»¥ä»<a href="https://releases.rs/">Rust Versions #</a> ç½‘ç«™è·å–åˆ°å½“å‰Rust stable/beta/nightly ç‰ˆæœ¬çš„æƒ…å†µï¼Œä»¥åŠå†å²ç‰ˆæœ¬ä¿¡æ¯ã€‚</p>

<p>å…³äºstable/beata/nightlyç‰ˆæœ¬ç­–ç•¥å’Œæ¼”è¿›ä»‹ç»å¯ä»¥å‚è€ƒï¼š<a href="https://rustwiki.org/zh-CN/book/appendix-07-nightly-rust.html">Rust æ˜¯å¦‚ä½•å¼€å‘çš„ä¸ â€œNightly Rustâ€</a></p>

<p>å¯¹äºå¼€å‘è€…æˆ‘ä»¬ä¸»è¦æŠ“ä½<strong>ç¨³å®šæ€§å·®å¼‚</strong>è¿™ä¸€ç‚¹ï¼Œä¸‰è€…ä¹‹é—´çš„ç¨³å®šæ€§ï¼šstable &gt; beta &gt; nightly</p>

<p><strong>æŸ¥çœ‹å½“å‰ç¯å¢ƒå®‰è£…äº†é‚£å‡ ä¸ªRustç‰ˆå’Œå·¥å…·é“¾</strong>ï¼š</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>rustup show
Default host: x86_64-unknown-linux-gnu
rustup home:  /home/flyflypeng/.rustup

installed toolchains
<span class="nt">--------------------</span>

stable-x86_64-unknown-linux-gnu <span class="o">(</span>default<span class="o">)</span>
nightly-x86_64-unknown-linux-gnu

installed targets <span class="k">for </span>active toolchain
<span class="nt">--------------------------------------</span>

wasm32-unknown-unknown
wasm32-wasi
x86_64-unknown-linux-gnu

active toolchain
<span class="nt">----------------</span>

stable-x86_64-unknown-linux-gnu <span class="o">(</span>default<span class="o">)</span>
rustc 1.68.0 <span class="o">(</span>2c8cc3432 2023-03-06<span class="o">)</span>
</code></pre></div></div>

<p><strong>å®‰è£…stable/beta/nightlyç‰ˆæœ¬ï¼š</strong></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>rustup <span class="nb">install </span>stable

<span class="nv">$ </span>rustup <span class="nb">install </span>beta

<span class="nv">$ </span>rustup <span class="nb">install </span>nightly
</code></pre></div></div>

<p><strong>å®‰è£…ç‰¹å®šç‰ˆæœ¬å·çš„Rustç‰ˆæœ¬ï¼š</strong></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>rustup <span class="nb">install </span>1.58.0

<span class="c"># é€šè¿‡rust show æŸ¥çœ‹å½“å‰ç¯å¢ƒä¸Šå·²ç»å®‰è£…çš„toolchain</span>
<span class="nv">$ </span>rustup show
Default host: x86_64-unknown-linux-gnu
rustup home:  /home/flyflypeng/.rustup

installed toolchains
<span class="nt">--------------------</span>

stable-x86_64-unknown-linux-gnu <span class="o">(</span>default<span class="o">)</span>
beta-x86_64-unknown-linux-gnu
nightly-x86_64-unknown-linux-gnu
1.58.0-x86_64-unknown-linux-gnu // ç¡®å®å®‰è£…æˆåŠŸäº†
</code></pre></div></div>

<p><strong>åœ¨ä¸åŒRustç‰ˆæœ¬ä¹‹é—´åˆ‡æ¢ï¼š</strong></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># åˆ‡æ¢åˆ°nightlyç‰ˆæœ¬</span>
<span class="nv">$ </span>rustup default nightly

<span class="c"># åˆ‡æ¢åˆ°stableç‰ˆæœ¬</span>
<span class="nv">$ </span>rustup default stable

<span class="c"># åˆ‡æ¢åˆ°æŒ‡å®šç‰ˆæœ¬å·çš„Rust</span>
<span class="nv">$ </span>rustup default 1.58.0
info: using existing <span class="nb">install </span><span class="k">for</span> <span class="s1">'1.58.0-x86_64-unknown-linux-gnu'</span>
info: default toolchain <span class="nb">set </span>to <span class="s1">'1.58.0-x86_64-unknown-linux-gnu'</span>

  1.58.0-x86_64-unknown-linux-gnu unchanged - rustc 1.58.0 <span class="o">(</span>02072b482 2022-01-11<span class="o">)</span>r

<span class="c"># éªŒè¯stableæˆ–nightlyç‰ˆæœ¬æ˜¯å¦åˆ‡æ¢æˆåŠŸï¼Œå¯ä»¥é€šè¿‡rustc --verisonè¿›è¡ŒæŸ¥çœ‹</span>
<span class="nv">$ </span>rustc <span class="nt">--version</span>
rustc 1.58.0 <span class="o">(</span>02072b482 2022-01-11<span class="o">)</span>
</code></pre></div></div>

<h2 id="21-rusté¡¹ç›®æºç ç›®å½•ä¸‹rust-toolchaintomlæ–‡ä»¶çš„ä½œç”¨æ˜¯ä»€ä¹ˆ">21. Rusté¡¹ç›®æºç ç›®å½•ä¸‹rust-toolchain.tomlæ–‡ä»¶çš„ä½œç”¨æ˜¯ä»€ä¹ˆ?</h2>

<p><code class="language-plaintext highlighter-rouge">rust-toolchain.toml</code>æ–‡ä»¶çš„ä½œç”¨æ˜¯ç”¨æ¥è®¾ç½®Rusté¡¹ç›®ç¼–è¯‘çš„ç¼–è¯‘å·¥å…·é“¾ï¼Œè¿™ä¸ªé…ç½®æ–‡ä»¶é€šå¸¸ç”¨åœ¨ä¸€äº›éœ€è¦ä½¿ç”¨åˆ°<code class="language-plaintext highlighter-rouge">nightly</code>ç‰ˆæœ¬ä¸­æ–°åŠŸèƒ½çš„é¡¹ç›®ï¼Œè¿™æ ·å¯ä»¥æŒ‡å®šRusté¡¹ç›®ä½¿ç”¨ç‰¹å®šçš„Rustç¼–è¯‘å·¥å…·é“¾è¿›è¡Œç¼–è¯‘<sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">1</a></sup>ã€‚</p>

<h2 id="22-rustä»£ç ä¸­å¦‚ä½•å®ç°æ¡ä»¶ç¼–è¯‘">22. Rustä»£ç ä¸­å¦‚ä½•å®ç°æ¡ä»¶ç¼–è¯‘ï¼Ÿ</h2>

<p>Cargoä¸­é€šè¿‡<code class="language-plaintext highlighter-rouge">features</code>æä¾›äº†ä¸€ç§è¡¨è¾¾==æ¡ä»¶ç¼–è¯‘å’Œå¯é€‰ä¾èµ–å…³ç³»çš„æœºåˆ¶==ã€‚
å¼€å‘è€…å¯ä»¥åœ¨<code class="language-plaintext highlighter-rouge">Cargo.toml</code>æ–‡ä»¶ä¸­çš„<code class="language-plaintext highlighter-rouge">[features]</code>é¡¹ä¸­å®šä¹‰ä¸€ç»„å‘½åçš„ç‰¹æ€§ï¼Œæ¯ä¸ªç‰¹æ€§éƒ½å¯ä»¥è¢«å¯ç”¨æˆ–ç¦ç”¨</p>

<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰<code class="language-plaintext highlighter-rouge">[features]</code> sectionä¸­å®šä¹‰çš„featureåŠŸèƒ½éƒ½æ˜¯é»˜è®¤å…³é—­çš„ï¼Œåªæœ‰å°†éœ€è¦å¯ç”¨çš„featureåŠ å…¥åˆ°<code class="language-plaintext highlighter-rouge">default feature</code>ä¸­ï¼Œè¿™æ ·æ‰èƒ½å†ç¼–è¯‘æ—¶includeè¿™äº›featureæ‰€è¦†ç›–çš„ä»£ç ã€‚</p>

<p>æœ‰æ—¶ä¸€ä¸ªCrateä¸­æä¾›äº†å¾ˆå¤šç‹¬ç«‹çš„åŠŸèƒ½ï¼Œå¹¶ä¸”é€šè¿‡<code class="language-plaintext highlighter-rouge">#[cfg(feature = "xxx")]</code>æ–¹å¼åœ¨ä»£ç ä¸­å®ç°æ¡ä»¶ç¼–è¯‘ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨å¼•å…¥ä¾èµ–æ—¶åŒæ—¶æŒ‡å®šéœ€è¦ä½¿ç”¨çš„ç‰¹å®šfeaturesï¼Œè¿™æ ·å¯ä»¥å®ç°==å¿«é€Ÿç¼–è¯‘å’Œå‡å°‘æœ€ç»ˆäºŒè¿›åˆ¶æ–‡ä»¶çš„å¤§å°ã€‚==</p>

<p>å¼€å¯ä¸€ä¸ªCrateä¸­æ‰€æœ‰featureåŠŸèƒ½å¯ä»¥ä½¿ç”¨ä¸‹é¢<code class="language-plaintext highlighter-rouge">full</code>å…³é”®è¯ï¼Œä¾‹å¦‚ï¼š</p>
<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">tokio</span> <span class="o">=</span> <span class="p">{</span> <span class="py">version</span> <span class="p">=</span> <span class="s">"1"</span><span class="p">,</span> <span class="py">features</span> <span class="p">=</span> <span class="p">[</span><span class="s">"full"</span><span class="p">]</span> <span class="p">}</span>
</code></pre></div></div>

<p>è¯¦ç»†çš„Cargo.tomlç§çš„<code class="language-plaintext highlighter-rouge">features</code>ç‰¹æ€§ä»‹ç»å¯ä»¥å‚è€ƒï¼š<a href="https://rustwiki.org/zh-CN/cargo/reference/features.html">Cargo Bookä¸­Featuresä»‹ç»</a></p>

<h2 id="23-ridentifierè¿™ç§åç§°çš„å˜é‡åæˆ–ç»“æ„ä½“æˆå‘˜åå¦‚ä½•ç†è§£">23. <code class="language-plaintext highlighter-rouge">r#&lt;identifier&gt;</code>è¿™ç§åç§°çš„å˜é‡åæˆ–ç»“æ„ä½“æˆå‘˜åå¦‚ä½•ç†è§£ï¼Ÿ</h2>

<p><code class="language-plaintext highlighter-rouge">r#&lt;identifier&gt;</code>ï¼ˆRust Bookä¸­ç§°è¿™ç§å‘½ä»¤æ–¹å¼ä¸º<a href="https://doc.rust-lang.org/book/appendix-01-keywords.html#raw-identifiers">Raw Identifier</a>ï¼‰è¿™ç§æ–¹å¼å‘½ä»¤çš„æ ‡è¯†ç¬¦ä½œä¸ºå˜é‡åç§°æˆ–ç»“æ„ä½“æˆå‘˜åç§°æ—¶ï¼Œä¸»è¦è§£å†³çš„æ˜¯<strong>identifieræ ‡è¯†ç¬¦åç§°ä¸Rustç³»ç»Ÿä¸­çš„å…³é”®å­—åŒåçš„é—®é¢˜</strong>ï¼Œè®©å·²ç»è¢«ä½œä¸ºRustå…³é”®å­—çš„åç§°ä¹Ÿå¯ä»¥ä½œä¸ºæºç ä¸­çš„æ ‡è¯†ç¬¦ä½¿ç”¨ã€‚</p>

<p>ä¾‹å¦‚ï¼Œ<code class="language-plaintext highlighter-rouge">match</code>æ˜¯Rustä¸­æ¨¡å¼åŒ¹é…è¯­æ³•çš„å…³é”®å­—ï¼Œå¦‚æœä½ å°†<code class="language-plaintext highlighter-rouge">match</code>ä½œä¸ºå‡½æ•°åï¼š</p>
<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">fn</span> <span class="k">match</span><span class="p">(</span><span class="n">needle</span><span class="p">:</span> <span class="o">&amp;</span><span class="nb">str</span><span class="p">,</span> <span class="n">haystack</span><span class="p">:</span> <span class="o">&amp;</span><span class="nb">str</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nb">bool</span> <span class="p">{</span> 
	<span class="n">haystack</span><span class="nf">.contains</span><span class="p">(</span><span class="n">needle</span><span class="p">)</span> 
<span class="p">}</span>
</code></pre></div></div>
<p>ç›´æ¥ç¼–è¯‘ä½ ä¼šé‡åˆ°ä¸‹é¢çš„é”™è¯¯æç¤ºï¼š</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>error: expected identifier, found keyword <span class="sb">`</span>match<span class="sb">`</span>
 <span class="nt">--</span><span class="o">&gt;</span> src/main.rs:4:4
  |
4 | fn match<span class="o">(</span>needle: &amp;str, haystack: &amp;str<span class="o">)</span> -&gt; bool <span class="o">{</span>
  |    ^^^^^ expected identifier, found keyword
</code></pre></div></div>
<p>ä¸Šé¢çš„é”™è¯¯æç¤ºè¯´ä½ è®²ä¸€ä¸ªRustä¸­çš„å…³é”®å­—ä½œä¸ºæ ‡è¯†ç¬¦ï¼Œè¿™æ˜¯ä¸ç¬¦åˆé¢„æœŸçš„ä½¿ç”¨æ–¹å¼ã€‚</p>

<p>ä½†æ˜¯å¦‚æœä½ éè¦å°†<code class="language-plaintext highlighter-rouge">match</code>ä½œä¸ºå‡½æ•°åï¼Œé‚£ä¹ˆä½ å°±éœ€è¦ç”¨ä¸Š<code class="language-plaintext highlighter-rouge">r#&lt;identifier&gt;</code>è¯­æ³•ç³–ï¼Œå‘Šè¯‰Rust<code class="language-plaintext highlighter-rouge">r#</code>åé¢identifierä¸åšä»»ä½•å…³é”®å­—é‡åæ£€æŸ¥ï¼Œåˆ¶ä½œidentifierå‘½ä»¤æ–¹å¼çš„æ£€æŸ¥ï¼Œä¸‹é¢å°±æ˜¯æ­£ç¡®çš„ç”¨æ³•ï¼š</p>
<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">fn</span> <span class="n">r</span><span class="err">#</span><span class="k">match</span><span class="p">(</span><span class="n">needle</span><span class="p">:</span> <span class="o">&amp;</span><span class="nb">str</span><span class="p">,</span> <span class="n">haystack</span><span class="p">:</span> <span class="o">&amp;</span><span class="nb">str</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nb">bool</span> <span class="p">{</span>
    <span class="n">haystack</span><span class="nf">.contains</span><span class="p">(</span><span class="n">needle</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nd">assert!</span><span class="p">(</span><span class="n">r</span>#<span class="k">match</span><span class="p">(</span><span class="s">"foo"</span><span class="p">,</span> <span class="s">"foobar"</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div></div>

<p>ç±»ä¼¼çš„æƒ…å†µï¼ŒRustä¸­è¿˜æœ‰<code class="language-plaintext highlighter-rouge">raw string</code>çš„æ¦‚å¿µï¼Œä¾‹å¦‚ä½ æƒ³åœ¨Rustä¸­ä¿å­˜ä¸€ä¸ªç”¨å­—ç¬¦ä¸²å¸¸é‡è¡¨ç¤ºçš„JSONæ ¼å¼å­—ç¬¦ä¸²ï¼Œä¸ºäº†è®©Rustä¸å¯¹å­—ç¬¦ä¸²ä¸­çš„çš„å¼•å·åšè½¬ä¹‰å¤„ç†ï¼Œä½ å¯ä»¥ç”¨ä¸‹é¢çš„æ–¹å¼æ¥ä½¿ç”¨ï¼š</p>
<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// æ³¨é‡Šæ‰ä¸‹é¢çš„è¯­å¥ä¼šæŠ¥ä¸‹é¢çš„é”™è¯¯ï¼š</span>
    <span class="c1">// error: expected one of `.`, `;`, `?`, `else`, or an operator, found `": 2023}"`</span>
    <span class="c1">// --&gt; src/main.rs:3:27</span>
    <span class="c1">// |</span>
    <span class="c1">// |     let json_str = "{"year": 2023}";</span>
    <span class="c1">// |                           ^^^^^^^^^ expected one of `.`, `;`, `?`, `else`, or an operator</span>
    
    <span class="c1">// æ­£ç¡®è®©å­—ç¬¦ä¸²ä¸­åŒ…å«åŒå¼•å·çš„æ–¹æ³•</span>
    <span class="k">let</span> <span class="n">json_str</span> <span class="o">=</span> <span class="s">"{</span><span class="se">\"</span><span class="s">year</span><span class="se">\"</span><span class="s">: 2023}"</span><span class="p">;</span>
    
    <span class="c1">// æˆ–è€…ä½¿ç”¨r#: raw stringçš„æ–¹å¼</span>
    <span class="k">let</span> <span class="n">new_json_str</span> <span class="o">=</span> <span class="s">r#"{"name": "Peter"}"#</span><span class="p">;</span>

    <span class="nd">println!</span><span class="p">(</span><span class="s">"Hello {}!"</span><span class="p">,</span> <span class="n">json_str</span><span class="p">);</span>
    <span class="nd">println!</span><span class="p">(</span><span class="s">"Happy {}!"</span><span class="p">,</span> <span class="n">new_json_str</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="23-å¼•ç”¨referenceä¸å€Ÿç”¨borrowçš„åŒºåˆ«">23. å¼•ç”¨(Reference)ä¸å€Ÿç”¨(Borrow)çš„åŒºåˆ«ï¼Ÿ</h2>

<p>ä»è¯­è¨€ä¸­è¯è¯­çš„åˆ†ç±»æ¥çœ‹ï¼Œ<strong>å¼•ç”¨æ˜¯ä¸€ä¸ªåè¯</strong>ï¼Œè¡¨ç¤ºä¸€ä¸ªå¯¹è±¡çš„åˆ«åï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªåˆ«åæ‰¾åˆ°èƒŒåå®é™…çš„å¯¹è±¡ï¼›è€Œ<strong>å€Ÿç”¨åˆ™æ˜¯ä¸€ä¸ªåŠ¨è¯</strong>ï¼Œè¡¨ç¤ºå‘ä¸€ä¸ªå¯¹è±¡å€Ÿç”¨äº†ä¸€äº›èµ„æºï¼ˆæ¯”å¦‚å¯¹è±¡çš„æ‰€æœ‰æƒï¼Œè®¿é—®å…¨å…´ç­‰ï¼‰ã€‚</p>

<p>è¿™ä¸¤è€…ä¹‹é—´çš„è”ç³»æ˜¯<strong>åˆ›å»ºä¸€ä¸ªå¼•ç”¨çš„è¡Œä¸º</strong>å°±å¯ä»¥ç§°ä¸ºæ˜¯<strong>å€Ÿç”¨</strong>ï¼Œä¾‹å¦‚ä¸‹é¢çš„ä»£ç ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª Stringç±»å‹çš„å¯¹è±¡sï¼Œç„¶ååˆ›å»ºä¸€ä¸ªæŒ‡å‘è¯¥Stringç±»å‹å¯¹è±¡sçš„å¼•ç”¨<code class="language-plaintext highlighter-rouge">&amp;s</code>ï¼ˆ<strong>å¯ä»¥ç†è§£ä¸ºä»å¯¹è±¡sé‚£é‡Œå€Ÿç”¨äº†è¯¥å¯¹è±¡çš„ä¸å¯å˜æ‰€æœ‰æƒ</strong>ï¼‰ï¼Œæœ€åå°†è¿™ä¸ªå¼•ç”¨ä¼ é€’ç»™<code class="language-plaintext highlighter-rouge">change</code>å‡½æ•°ä½¿ç”¨ï¼Œå½“ä½¿ç”¨å®Œæ¯•åï¼Œè¿˜æ˜¯éœ€è¦å°†å€Ÿç”¨çš„ä¸å¯å˜æ‰€æœ‰æƒè¿˜ç»™Stringç±»å‹å¯¹è±¡sã€‚</p>

<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">let</span> <span class="n">s</span> <span class="o">=</span> <span class="nn">String</span><span class="p">::</span><span class="nf">from</span><span class="p">(</span><span class="s">"hello"</span><span class="p">);</span>

    <span class="nf">change</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="nf">change</span><span class="p">(</span><span class="n">some_string</span><span class="p">:</span> <span class="o">&amp;</span><span class="nb">String</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">some_string</span><span class="nf">.push_str</span><span class="p">(</span><span class="s">", world"</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="24-mapå‡½æ•°é—­åŒ…ä¸­ä¼ å…¥å‚æ•°xå’Œxçš„åŒºåˆ«æ˜¯ä»€ä¹ˆ">24. mapå‡½æ•°é—­åŒ…ä¸­ä¼ å…¥å‚æ•°<code class="language-plaintext highlighter-rouge">x</code>å’Œ<code class="language-plaintext highlighter-rouge">&amp;x</code>çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h2>

<p>å‡½æ•°é—­åŒ…ä¸­çš„å‚æ•°</p>

<h2 id="25-supertraitæ¦‚å¿µ">25. supertraitæ¦‚å¿µ</h2>

<p>Rustä¸­<strong>æ²¡æœ‰ç»§æ‰¿çš„æ¦‚å¿µ</strong>ï¼Œä½†æ˜¯å¼€å‘è€…å¯ä»¥é€šè¿‡ä¸º<strong>subtraitå®šä¹‰ä¸Šå±‚æ›´æŠ½è±¡çš„supertrait</strong>æ¥å®ç°ç±»ä¼¼é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­çš„ç»§æ‰¿æœºåˆ¶ã€‚</p>

<p>ä¾‹å­ï¼š</p>
<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">trait</span> <span class="n">Person</span> <span class="p">{</span>
    <span class="k">fn</span> <span class="nf">name</span><span class="p">(</span><span class="o">&amp;</span><span class="k">self</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nb">String</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Personæ˜¯Studentçš„supertrait</span>
<span class="c1">// å¦‚æœæŸä¸ªç±»å‹éœ€è¦å®ç°Student trait, é‚£ä¹ˆå®ƒåŒæ—¶ä¹Ÿè¦å®ç°Person trait</span>
<span class="k">trait</span> <span class="n">Student</span><span class="p">:</span> <span class="n">Person</span> <span class="p">{</span>
    <span class="k">fn</span> <span class="nf">university</span><span class="p">(</span><span class="o">&amp;</span><span class="k">self</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nb">String</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">trait</span> <span class="n">Programmer</span> <span class="p">{</span>
    <span class="k">fn</span> <span class="nf">fav_language</span><span class="p">(</span><span class="o">&amp;</span><span class="k">self</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nb">String</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Studentå’ŒProgrammeræ˜¯ComputerScienceStudentçš„ç›´æ¥supertrait</span>
<span class="c1">// è€ŒPersonåˆ™æ˜¯ComputerScienceStudentçš„ä¸Šä¸Šå±‚supertrait</span>
<span class="k">trait</span> <span class="n">ComputerScienceStudent</span><span class="p">:</span> <span class="n">Student</span> <span class="o">+</span> <span class="n">Programmer</span> <span class="p">{</span>
    <span class="k">fn</span> <span class="nf">study_lessons</span><span class="p">(</span><span class="o">&amp;</span><span class="k">self</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nb">String</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="nf">comp_sci_student_greeting</span><span class="p">(</span><span class="n">student</span><span class="p">:</span> <span class="o">&amp;</span><span class="k">dyn</span> <span class="n">ComputerScienceStudent</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nb">String</span> <span class="p">{</span>
    <span class="nd">format!</span><span class="p">(</span>
        <span class="s">"My name is {}, and I attend {}. My favorite language is {}. My study lessons is {}"</span><span class="p">,</span>
        <span class="n">student</span><span class="nf">.name</span><span class="p">(),</span>
        <span class="n">student</span><span class="nf">.university</span><span class="p">(),</span>
        <span class="n">student</span><span class="nf">.fav_language</span><span class="p">(),</span>
        <span class="n">student</span><span class="nf">.study_lessons</span><span class="p">(),</span>
    <span class="p">)</span>
<span class="p">}</span>

<span class="k">struct</span> <span class="n">Nothing</span> <span class="p">{}</span>

<span class="k">impl</span> <span class="n">Person</span> <span class="k">for</span> <span class="n">Nothing</span> <span class="p">{</span>
    <span class="k">fn</span> <span class="nf">name</span><span class="p">(</span><span class="o">&amp;</span><span class="k">self</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nb">String</span> <span class="p">{</span>
        <span class="s">"Tom"</span><span class="nf">.to_string</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">impl</span> <span class="n">Student</span> <span class="k">for</span> <span class="n">Nothing</span> <span class="p">{</span>
    <span class="k">fn</span> <span class="nf">university</span><span class="p">(</span><span class="o">&amp;</span><span class="k">self</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nb">String</span> <span class="p">{</span>
        <span class="s">"MIT"</span><span class="nf">.to_string</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">impl</span> <span class="n">Programmer</span> <span class="k">for</span> <span class="n">Nothing</span> <span class="p">{</span>
    <span class="k">fn</span> <span class="nf">fav_language</span><span class="p">(</span><span class="o">&amp;</span><span class="k">self</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nb">String</span> <span class="p">{</span>
        <span class="s">"Rust"</span><span class="nf">.to_string</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">impl</span> <span class="n">ComputerScienceStudent</span> <span class="k">for</span> <span class="n">Nothing</span> <span class="p">{</span>
    <span class="k">fn</span> <span class="nf">study_lessons</span><span class="p">(</span><span class="o">&amp;</span><span class="k">self</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nb">String</span> <span class="p">{</span>
        <span class="s">"Operating System"</span><span class="nf">.to_string</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">let</span> <span class="n">t</span> <span class="o">=</span> <span class="n">Nothing</span> <span class="p">{};</span>

    <span class="nd">println!</span><span class="p">(</span><span class="s">"{}"</span><span class="p">,</span> <span class="nf">comp_sci_student_greeting</span><span class="p">(</span><span class="o">&amp;</span><span class="n">t</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="26-rustä¸­å¦‚ä½•å®ç°ç±»ä¼¼cè¯­è¨€ä¸­sizeofå‡½æ•°æŸ¥çœ‹å˜é‡å ç”¨å­˜å‚¨ç©ºé—´å¤§å°çš„åŠŸèƒ½">26. Rustä¸­å¦‚ä½•å®ç°ç±»ä¼¼Cè¯­è¨€ä¸­sizeofå‡½æ•°æŸ¥çœ‹å˜é‡å ç”¨å­˜å‚¨ç©ºé—´å¤§å°çš„åŠŸèƒ½ï¼Ÿ</h2>

<p>åœ¨<code class="language-plaintext highlighter-rouge">std::mem</code> crateä¸­æœ‰ä¸¤ä¸ªsizeofç›¸å…³çš„å‡½æ•°ï¼š</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">std::mem::size_of</code>ï¼šè¿”å›æŒ‡å®šç±»å‹æ‰€å ç”¨çš„å†…å­˜ç©ºé—´å¤§å°ï¼ˆä»¥byteå­—èŠ‚ä¸ºå•ä½ï¼‰</li>
  <li><code class="language-plaintext highlighter-rouge">std::mem::size_of_val</code>ï¼šè¿”å›å˜é‡æ‰€å®é™…æŒ‡å‘çš„å€¼æ‰€å ç”¨çš„å†…å­˜ç©ºé—´å¤§å°ï¼ˆä»¥byteå­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚<strong>æ³¨æ„ä¸‹é¢ä¾‹å­ä¸­å…³äºsize_of_val(&amp;String)ç±»å‹å’ŒString::len()ä¸¤ä¸ªå‡½æ•°è¿”å›å¤§å°çš„å·®å¼‚ã€‚</strong></li>
</ul>

<p>ä¾‹å­ï¼š</p>
<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">use</span> <span class="nn">std</span><span class="p">::</span><span class="n">mem</span><span class="p">;</span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">let</span> <span class="n">s1</span> <span class="o">=</span> <span class="nn">String</span><span class="p">::</span><span class="nf">from</span><span class="p">(</span><span class="s">"Hello"</span><span class="p">);</span>
    <span class="k">let</span> <span class="n">s</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">s1</span><span class="p">;</span>
    <span class="k">let</span> <span class="n">len</span> <span class="o">=</span> <span class="nf">cal_string_len</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>

    <span class="nd">println!</span><span class="p">(</span><span class="s">"The length of {} is {}"</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">len</span><span class="p">);</span>

    <span class="c1">// é€šè¿‡String::len()è¿”å›çš„æ˜¯heapä¸Šå®é™…å­˜å‚¨å­—ç¬¦ä¸²çš„å†…å­˜ç©ºé—´å¤§å°</span>
    <span class="c1">// std::mem::size_of_valè¿”å›çš„æ˜¯Stringç±»å‹å˜é‡åœ¨æ ˆä¸Šå­˜å‚¨çš„å¤§å°ç­‰äº24ï¼Œå°±æ˜¯&lt;ptr, cap, size&gt;ä¸‰ä¸ªusizeå˜é‡å¤§å°ä¹‹å’Œ</span>
    <span class="nd">assert_eq!</span><span class="p">(</span><span class="n">s</span><span class="nf">.len</span><span class="p">(),</span> <span class="mi">5</span><span class="p">);</span>
    <span class="nd">assert_eq!</span><span class="p">(</span><span class="nn">mem</span><span class="p">::</span><span class="nf">size_of_val</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s</span><span class="p">),</span> <span class="mi">24</span><span class="p">);</span>

    <span class="c1">// æŸ¥çœ‹Stringç±»å‹å’Œ&amp;Stringå¼•ç”¨ç±»å‹çš„å¤§å°</span>
    <span class="nd">println!</span><span class="p">(</span><span class="s">"size_of::&lt;String&gt;(): {}"</span><span class="p">,</span> <span class="nn">mem</span><span class="p">::</span><span class="nn">size_of</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span><span class="p">());</span>
    <span class="nd">println!</span><span class="p">(</span><span class="s">"size_of::&lt;&amp;String&gt;(): {}"</span><span class="p">,</span> <span class="nn">mem</span><span class="p">::</span><span class="nn">size_of</span><span class="p">::</span><span class="o">&lt;&amp;</span><span class="nb">String</span><span class="o">&gt;</span><span class="p">());</span>

    <span class="c1">// æŸ¥çœ‹ç³»ç»Ÿä¸­usizeç±»å‹çš„å¤§å°</span>
    <span class="nd">println!</span><span class="p">(</span><span class="s">"size_of::&lt;usize&gt;(): {}"</span><span class="p">,</span> <span class="nn">mem</span><span class="p">::</span><span class="nn">size_of</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">usize</span><span class="o">&gt;</span><span class="p">());</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="nf">cal_string_len</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="o">&amp;</span><span class="nb">String</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nb">usize</span> <span class="p">{</span>
    <span class="n">s</span><span class="nf">.len</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div></div>

<p>å¯¹äºRustå¸¸è§çš„æŒ‡é’ˆã€å¼•ç”¨ã€<code class="language-plaintext highlighter-rouge">Box&lt;T&gt;</code>ç­‰è¿™äº›ç±»å‹çš„å€¼çš„å¤§å°éƒ½æ˜¯<strong>usize</strong>ã€‚</p>

<blockquote>
  <p>The typesÂ <code class="language-plaintext highlighter-rouge">*const T</code>,Â <code class="language-plaintext highlighter-rouge">&amp;T</code>,Â <code class="language-plaintext highlighter-rouge">Box&lt;T&gt;</code>,Â <code class="language-plaintext highlighter-rouge">Option&lt;&amp;T&gt;</code>, andÂ <code class="language-plaintext highlighter-rouge">Option&lt;Box&lt;T&gt;&gt;</code>Â all have the same size. IfÂ <code class="language-plaintext highlighter-rouge">T</code>Â is Sized, all of those types have the same size asÂ <code class="language-plaintext highlighter-rouge">usize</code>. â€“ <a href="https://doc.rust-lang.org/std/mem/fn.size_of.html">std::mem::size_of</a></p>
</blockquote>

<p>ä¸‹é¢æ”¾ä¸€ä¸ª<code class="language-plaintext highlighter-rouge">&amp;String</code>, <code class="language-plaintext highlighter-rouge">String</code>ä»¥åŠStringç±»å‹å­—ç¬¦ä¸²å®é™…åœ¨å †å†…å­˜ä¸Šå­˜å‚¨ç»“æ„çš„å…³ç³»ï¼Œå°±æ›´åŠ å®¹æ˜“ç†è§£ä¸Šé¢çš„ä¾‹å­ï¼Œä»¥åŠå¼•ç”¨ä¸æŒ‡é’ˆçš„åŒºåˆ«ã€‚</p>

<p><img src="https://picturebed.obs.cn-east-2.myhuaweicloud.com/blogPictures/20230318230649.png" alt="" /></p>

<h2 id="27-å¦‚ä½•ç†è§£rustä¸­çš„è‡ªåŠ¨è§£å¼•ç”¨">27. å¦‚ä½•ç†è§£Rustä¸­çš„è‡ªåŠ¨è§£å¼•ç”¨ï¼Ÿ</h2>

<p>è‡ªå·±ä¸»è¦çœ‹äº†äº†è¿™ç¯‡æ–‡æ–‡ç« å—å¯å‘è¾ƒå¤§ï¼š<a href="https://course.rs/advance/smart-pointer/deref.html">Rustè¯­è¨€åœ£ç» - Deref è§£å¼•ç”¨</a></p>

<p>Rustä¸­ç¼–è¯‘å™¨å¯ä»¥å®ç°ä¸‹é¢ä¸¤ç§å…³äºDerefçš„é‡è¦èƒ½åŠ›ï¼š</p>
<ul>
  <li><strong>éšå¼åœ°è‡ªåŠ¨</strong> Deref è§£å¼•ç”¨è½¬æ¢</li>
  <li><strong>è¿ç»­åœ°è‡ªåŠ¨åœ°éšå¼</strong> Deref è§£å¼•ç”¨è½¬æ¢</li>
</ul>

<p>ä¸‹é¢çš„ä¾‹å­ä¸­å°±ä»‹ç»äº†è¿™ä¸¤ç§éšå¼çš„Derefè§£å¼•ç”¨ä½¿ç”¨åœºæ™¯ï¼š</p>
<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">fn</span> <span class="nf">display</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="o">&amp;</span><span class="nb">str</span><span class="p">)</span> <span class="p">{</span>
    <span class="nd">println!</span><span class="p">(</span><span class="s">"{}"</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// case 1: è‡ªåŠ¨Derefè§£å¼•ç”¨</span>
    <span class="k">let</span> <span class="n">s</span> <span class="o">=</span> <span class="nn">String</span><span class="p">::</span><span class="nf">from</span><span class="p">(</span><span class="s">"Hello"</span><span class="p">);</span>
    <span class="c1">// æ³¨æ„ï¼šè¿™é‡Œä¼ å…¥çš„&amp;sçš„æ•°æ®ç±»å‹æ˜¯&amp;String, è€Œdisplayå‡½æ•°å®šä¹‰çš„å‚æ•°ç±»å‹æ˜¯&amp;str</span>
    <span class="c1">// å®ç°ä»&amp;String -&gt; &amp;strç±»å‹ä¹‹é—´çš„è½¬æ¢çš„èƒŒåï¼Œå°±æ˜¯Rustç¼–è¯‘é€šè¿‡Derefè‡ªåŠ¨è§£å¼•ç”¨å¸®æˆ‘ä»¬åšçš„</span>
    <span class="c1">// ä¹Ÿå°±æ˜¯åœ¨æ ‡å‡†åº“ä¸­å®ç°String: Deref&lt;&amp;str&gt;çš„Deref traitï¼Œæ ‡å‡†åº“ä¸­çš„ä»£ç å¦‚ä¸‹ï¼š</span>
    <span class="c1">// #[stable(feature = "rust1", since = "1.0.0")]</span>
    <span class="c1">// impl ops::Deref for String {</span>
    <span class="c1">// type Target = str;</span>
    <span class="c1">// #[inline]</span>
    <span class="c1">// fn deref(&amp;self) -&gt; &amp;str {</span>
    <span class="c1">//     unsafe { str::from_utf8_unchecked(&amp;self.vec) }</span>
    <span class="c1">// }</span>
    <span class="c1">// }</span>
    <span class="nf">display</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s</span><span class="p">);</span>

    <span class="c1">// case 2: è¿ç»­è‡ªåŠ¨Derefè§£å¼•ç”¨</span>
    <span class="k">let</span> <span class="n">b</span> <span class="o">=</span> <span class="nn">Box</span><span class="p">::</span><span class="nf">new</span><span class="p">(</span><span class="nn">String</span><span class="p">::</span><span class="nf">from</span><span class="p">(</span><span class="s">"World"</span><span class="p">));</span>
    <span class="c1">// æ³¨æ„ï¼š1. é¦–å…ˆ&amp;bæ˜¯&amp;Box&lt;String&gt;ç±»å‹ï¼Œé€šè¿‡å®ƒçš„Derefè§£å¼•ç”¨ï¼Œå¯ä»¥è·å–åˆ°&amp;Stringç±»å‹å¼•ç”¨</span>
    <span class="c1">//      2. ç„¶ååœ¨è¿ç»­è‡ªåŠ¨çš„è°ƒç”¨&amp;String -&gt; &amp;strçš„Derefè§£å¼•ç”¨</span>
    <span class="c1">//     #[stable(feature = "rust1", since = "1.0.0")]</span>
    <span class="c1">//     impl&lt;T: ?Sized, A: Allocator&gt; Deref for Box&lt;T, A&gt; {</span>
    <span class="c1">//     type Target = T;</span>
    <span class="c1">//     fn deref(&amp;self) -&gt; &amp;T {</span>
    <span class="c1">//         &amp;**self // è¿™é‡Œä¸ºä»€ä¹ˆè¦ç”¨ä¸¤ä¸ª*ï¼Ÿå› ä¸ºç¬¬ä¸€ä¸ª*æ˜¯è§£&amp;Box&lt;String&gt;, ç¬¬2ä¸ªæ˜¯è§£Box&lt;String&gt;å¾—åˆ°Stringç±»å‹</span>
    <span class="c1">//     }</span>
    <span class="c1">// }</span>
    <span class="nf">display</span><span class="p">(</span><span class="o">&amp;</span><span class="n">b</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>å…³äº<code class="language-plaintext highlighter-rouge">Deref</code>çš„è‡ªåŠ¨è§£å¼•ç”¨è§„åˆ™æ€»ç»“ï¼š</p>
<ul>
  <li>ä¸€ä¸ªç±»å‹ä¸º<code class="language-plaintext highlighter-rouge">T</code>çš„å¯¹è±¡<code class="language-plaintext highlighter-rouge">foo</code>ï¼Œå¦‚æœ<code class="language-plaintext highlighter-rouge">T: Deref&lt;Target=U&gt;</code>ï¼Œé‚£ä¹ˆæœ‰å…³<code class="language-plaintext highlighter-rouge">foo</code>çš„å¼•ç”¨<code class="language-plaintext highlighter-rouge">&amp;foo</code>åœ¨ä½¿ç”¨æ—¶å¯ä»¥<strong>è‡ªåŠ¨åœ°è½¬æ¢</strong>ä¸º<code class="language-plaintext highlighter-rouge">&amp;U</code>ç±»å‹ã€‚</li>
  <li>è§¦å‘Derefè‡ªåŠ¨è§£å¼•ç”¨çš„æ¡ä»¶å°±æ˜¯<strong>å­˜åœ¨<code class="language-plaintext highlighter-rouge">&amp;T</code> -&gt; <code class="language-plaintext highlighter-rouge">&amp;U</code>å¼•ç”¨ç±»å‹è½¬æ¢</strong>ï¼Œä¸€èˆ¬å‡½æ•°è°ƒç”¨ä¼ é€’å¼•ç”¨çš„åœºæ™¯å­˜åœ¨è¾ƒå¤šçš„è‡ªåŠ¨è§£å¼•ç”¨è½¬æ¢</li>
</ul>

<p><strong>å¼•ç”¨å½’ä¸€åŒ–</strong>
åœ¨Rustæ ‡å‡†åº“ä¸­æœ‰ä¸€ä¸ªéå¸¸æœ‰æ„æ€çš„ä¸€æ®µä»£ç ï¼š</p>
<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">impl</span><span class="o">&lt;</span><span class="n">T</span><span class="p">:</span> <span class="o">?</span><span class="nb">Sized</span><span class="o">&gt;</span> <span class="n">Deref</span> <span class="k">for</span> <span class="o">&amp;</span><span class="n">T</span> <span class="p">{</span>
    <span class="k">type</span> <span class="n">Target</span> <span class="o">=</span> <span class="n">T</span><span class="p">;</span>

    <span class="k">fn</span> <span class="nf">deref</span><span class="p">(</span><span class="o">&amp;</span><span class="k">self</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="o">&amp;</span><span class="n">T</span> <span class="p">{</span>
        <span class="o">*</span><span class="k">self</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>ä¸è¿‡è¿™æ®µä»£ç å†™æˆä¸‹é¢çš„æ–¹å¼ï¼Œæ›´å®¹æ˜“ç†è§£ï¼š</p>
<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">impl</span><span class="o">&lt;</span><span class="n">T</span><span class="p">:</span> <span class="o">?</span><span class="nb">Sized</span><span class="o">&gt;</span> <span class="n">Deref</span> <span class="k">for</span> <span class="o">&amp;</span><span class="n">T</span> <span class="p">{</span>
    <span class="k">type</span> <span class="n">Target</span> <span class="o">=</span> <span class="n">T</span><span class="p">;</span>

    <span class="k">fn</span> <span class="nf">deref</span><span class="p">(</span><span class="k">self</span><span class="p">:</span> <span class="o">&amp;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">T</span><span class="p">))</span> <span class="k">-&gt;</span> <span class="o">&amp;</span><span class="n">T</span> <span class="p">{</span>
        <span class="o">*</span><span class="k">self</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>è¿™æ®µä»£ç æ‰€èƒ½å¤Ÿå®ç°çš„å†…å®¹å°±æ˜¯å¯ä»¥å®ç°ä»<code class="language-plaintext highlighter-rouge">&amp;&amp;&amp;&amp;&amp;T -&gt; &amp;T</code>ç±»å‹çš„è½¬æ¢ï¼Œä¸æ–­åœ°è„±å»å¤–é¢å†—é•¿çš„<code class="language-plaintext highlighter-rouge">&amp;</code>å¼•ç”¨ç¬¦ï¼Œç›´åˆ°è¿”å›æœ€ç»ˆå®é™…æŒ‡å‘çš„<code class="language-plaintext highlighter-rouge">&amp;T</code>ç±»å‹çš„å¼•ç”¨ã€‚</p>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:1" role="doc-endnote">
      <p><a href="https://rust-lang.github.io/rustup/overrides.html?highlight=rust-toolchain.toml#the-toolchain-file">The toolchain file</a>Â <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>

</article>



<section class="tags">
  <strong>Tags:</strong> <a href="/tag/Rust">Rust</a>,&nbsp;<a href="/tag/ç¼–ç¨‹è¯­è¨€">ç¼–ç¨‹è¯­è¨€</a>
</section>



<section class="rss">
  <p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
</section>

<section class="share">
  <span>Share: </span>
  
    
    
      <a href="//twitter.com/share?text=100%E4%B8%AARust%E9%97%AE%E9%A2%98&url=http%3A%2F%2Flocalhost%3A4000%2F%25E7%25BC%2596%25E7%25A8%258B%25E8%25AF%25AD%25E8%25A8%2580%2F2023%2F03%2F19%2F100%25E4%25B8%25AARust%25E9%2597%25AE%25E9%25A2%2598.html&via=flyflypeng_bear"
        onclick="window.open(this.href, 'twitter-share', 'width=550,height=255');return false;">
        <i class="fa fa-twitter-square fa-lg"></i>
      </a>
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
</section>

	<section class="post-navigation">
		<span class="prev-post">
			
				<a href="/%E8%AE%BA%E6%96%87/2023/01/29/%E8%AE%BA%E6%96%87%E5%88%86%E4%BA%AB-VirtualFlow-MLSys-2022.html">
					<span class="fa-stack fa-lg">
						<i class="fa fa-square fa-stack-2x"></i>
						<i class="fa fa-angle-double-left fa-stack-1x fa-inverse"></i>
					</span>
					<span class="page-number">è®ºæ–‡åˆ†äº« - VirtualFlow: Decoupling Deep Learning Models from the underlying Hardware</span>
				</a>
			
		</span>
		<span class="next-post">
			
				<a href="/%E4%BA%91%E5%8E%9F%E7%94%9F/2023/03/29/Overlay-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F.html">
					<span class="page-number">OverlayFs æ–‡ä»¶ç³»ç»Ÿä»‹ç»</span>
					<span class="fa-stack fa-lg">
						<i class="fa fa-square fa-stack-2x"></i>
						<i class="fa fa-angle-double-right fa-stack-1x fa-inverse"></i>
					</span>
				</a>
			
		</span>
	</section>




<section class="disqus">
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_shortname = 'flyflypeng-tech';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>



</div>
</div>

    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h3 class="footer-heading">Fly Higher's Blog</h3>

    <div class="site-navigation">

      <p><strong>Site Map</strong></p>
      <ul class="pages">
        <li class="nav-link"><a href="/about/">About</a>
        <li class="nav-link"><a href="/posts/">Posts</a>
        <li class="nav-link"><a href="/project/">Projects</a>
       <!--  
        
          <li class="nav-link"><a href="/about/">About</a>
        
        
        
        
        
        
        
        
        
          <li class="nav-link"><a href="/posts/">Posts</a>
        
        
        
          <li class="nav-link"><a href="/project/">Projects</a>
        
        
        
          <li class="nav-link"><a href="/tag/keyboard/">keyboard</a>
        
        
        
          <li class="nav-link"><a href="/tag/virtual/">virtual</a>
        
        
        
          <li class="nav-link"><a href="/tag/android/">Android</a>
        
        
        
          <li class="nav-link"><a href="/tag/opencv/">opencv</a>
        
        
        
          <li class="nav-link"><a href="/tag/markdown/">Markdown</a>
        
        
        
          <li class="nav-link"><a href="/tag/%E8%8B%B1%E8%AF%AD/">è‹±è¯­</a>
        
        
        
          <li class="nav-link"><a href="/tag/%E5%AD%A6%E4%B9%A0/">å­¦ä¹ </a>
        
        
        
          <li class="nav-link"><a href="/tag/hexo/">Hexo</a>
        
        
        
          <li class="nav-link"><a href="/tag/%E5%8D%9A%E5%AE%A2/">åšå®¢</a>
        
        
        
          <li class="nav-link"><a href="/tag/ubuntu/">Ubuntu</a>
        
        
        
          <li class="nav-link"><a href="/tag/firefox/">Firefox</a>
        
        
        
          <li class="nav-link"><a href="/tag/python/">Python</a>
        
        
        
          <li class="nav-link"><a href="/tag/make/">make</a>
        
        
        
          <li class="nav-link"><a href="/tag/makefile/">Makefile</a>
        
        
        
          <li class="nav-link"><a href="/tag/linux/">Linux</a>
        
        
        
          <li class="nav-link"><a href="/tag/sublimetext/">SublimeText</a>
        
        
        
          <li class="nav-link"><a href="/tag/%E5%86%85%E6%A0%B8/">å†…æ ¸</a>
        
        
        
          <li class="nav-link"><a href="/tag/%E8%B0%83%E5%BA%A6/">è°ƒåº¦</a>
        
        
        
          <li class="nav-link"><a href="/tag/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">æ“ä½œç³»ç»Ÿ</a>
        
        
        
          <li class="nav-link"><a href="/tag/%E7%A1%AC%E7%9B%98/">ç¡¬ç›˜</a>
        
        
        
          <li class="nav-link"><a href="/tag/%E8%AE%A1%E7%AE%97%E6%9C%BA/">è®¡ç®—æœº</a>
        
        
        
          <li class="nav-link"><a href="/tag/terminator/">Terminator</a>
        
        
        
          <li class="nav-link"><a href="/tag/cpu/">CPU</a>
        
        
        
          <li class="nav-link"><a href="/tag/%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/">ä½“ç³»ç»“æ„</a>
        
        
        
          <li class="nav-link"><a href="/tag/%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8/">ç³»ç»Ÿè°ƒç”¨</a>
        
        
        
          <li class="nav-link"><a href="/tag/%E6%97%B6%E9%97%B4%E7%AE%A1%E7%90%86/">æ—¶é—´ç®¡ç†</a>
        
        
        
          <li class="nav-link"><a href="/tag/vnc/">VNC</a>
        
        
        
          <li class="nav-link"><a href="/tag/rfb/">RFB</a>
        
        
        
          <li class="nav-link"><a href="/tag/container-of/">container_of</a>
        
        
        
          <li class="nav-link"><a href="/tag/offsetof/">offsetof</a>
        
        
        
          <li class="nav-link"><a href="/tag/cs/">CS</a>
        
        
        
          <li class="nav-link"><a href="/tag/%E5%9F%BA%E7%A1%80/">åŸºç¡€</a>
        
        
        
          <li class="nav-link"><a href="/tag/%E9%98%85%E8%AF%BB/">é˜…è¯»</a>
        
        
        
          <li class="nav-link"><a href="/tag/%E4%B9%A6%E5%8D%95/">ä¹¦å•</a>
        
        
        
          <li class="nav-link"><a href="/tag/%E5%B0%8F%E8%AF%B4/">å°è¯´</a>
        
        
        
          <li class="nav-link"><a href="/tag/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a>
        
        
        
          <li class="nav-link"><a href="/tag/ndk/">NDK</a>
        
        
        
          <li class="nav-link"><a href="/tag/debug/">Debug</a>
        
        
        
          <li class="nav-link"><a href="/tag/tombstone/">Tombstone</a>
        
        
        
          <li class="nav-link"><a href="/tag/eof/">EOF</a>
        
        
        
          <li class="nav-link"><a href="/tag/git/">Git</a>
        
        
        
          <li class="nav-link"><a href="/tag/ppa/">PPA</a>
        
        
        
          <li class="nav-link"><a href="/tag/apt/">APT</a>
        
        
        
          <li class="nav-link"><a href="/tag/%E5%90%8C%E6%AD%A5/">åŒæ­¥</a>
        
        
        
          <li class="nav-link"><a href="/tag/%E7%94%9F%E4%BA%A7%E8%80%85%E6%B6%88%E8%B4%B9%E8%80%85/">ç”Ÿäº§è€…æ¶ˆè´¹è€…</a>
        
        
        
          <li class="nav-link"><a href="/tag/%E7%8E%AF%E5%BD%A2%E7%BC%93%E5%86%B2%E5%8C%BA/">ç¯å½¢ç¼“å†²åŒº</a>
        
        
        
          <li class="nav-link"><a href="/tag/ringbuffer/">RingBuffer</a>
        
        
        
          <li class="nav-link"><a href="/tag/aosp/">AOSP</a>
        
        
        
          <li class="nav-link"><a href="/tag/hal/">HAL</a>
        
        
        
          <li class="nav-link"><a href="/tag/ramfs/">ramfs</a>
        
        
        
          <li class="nav-link"><a href="/tag/tmpfs/">tmpfs</a>
        
        
        
          <li class="nav-link"><a href="/tag/rootfs/">rootfs</a>
        
        
        
          <li class="nav-link"><a href="/tag/initramfs/">initramfs</a>
        
        
        
          <li class="nav-link"><a href="/tag/%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/">æ–‡ä»¶ç³»ç»Ÿ</a>
        
        
        
          <li class="nav-link"><a href="/tag/unix/">Unix</a>
        
        
        
          <li class="nav-link"><a href="/tag/i-o/">I/O</a>
        
        
        
          <li class="nav-link"><a href="/tag/graphic/">Graphic</a>
        
        
        
          <li class="nav-link"><a href="/tag/opengles/">OpenGLES</a>
        
        
        
          <li class="nav-link"><a href="/tag/egl/">EGL</a>
        
        
        
          <li class="nav-link"><a href="/tag/%E8%99%9A%E6%8B%9F%E5%8C%96/">è™šæ‹ŸåŒ–</a>
        
        
        
          <li class="nav-link"><a href="/tag/qemu/">QEMU</a>
        
        
        
          <li class="nav-link"><a href="/tag/kvm/">KVM</a>
        
        
        
          <li class="nav-link"><a href="/tag/mac/">Mac</a>
        
        
        
          <li class="nav-link"><a href="/tag/jekyll/">Jekyll</a>
        
        
        
          <li class="nav-link"><a href="/tag/iterm2/">iTerm2</a>
        
        
        
          <li class="nav-link"><a href="/tag/zsh/">zsh</a>
        
        
        
          <li class="nav-link"><a href="/tag/kubernetes/">kubernetes</a>
        
        
        
          <li class="nav-link"><a href="/tag/k8s/">k8s</a>
        
        
        
          <li class="nav-link"><a href="/tag/cloudnative/">cloudnative</a>
        
        
        
          <li class="nav-link"><a href="/tag/%E6%88%B7%E5%A4%96/">æˆ·å¤–</a>
        
        
        
          <li class="nav-link"><a href="/tag/%E9%9C%B2%E8%90%A5/">éœ²è¥</a>
        
        
        
          <li class="nav-link"><a href="/tag/camp/">camp</a>
        
        
        
          <li class="nav-link"><a href="/tag/%E7%AC%94%E8%AE%B0/">ç¬”è®°</a>
        
        
        
          <li class="nav-link"><a href="/tag/%E4%BA%91%E5%8E%9F%E7%94%9F/">äº‘åŸç”Ÿ</a>
        
        
        
          <li class="nav-link"><a href="/tag/ptrace/">ptrace</a>
        
        
        
          <li class="nav-link"><a href="/tag/sandbox/">sandbox</a>
        
        
        
          <li class="nav-link"><a href="/tag/kata-containers/">kata-containers</a>
        
        
        
          <li class="nav-link"><a href="/tag/vscode/">vscode</a>
        
        
        
          <li class="nav-link"><a href="/tag/kernel/">kernel</a>
        
        
        
          <li class="nav-link"><a href="/tag/mlsys/">MLSys</a>
        
        
        
          <li class="nav-link"><a href="/tag/%E8%AE%BA%E6%96%87/">è®ºæ–‡</a>
        
        
        
          <li class="nav-link"><a href="/tag/ai/">AI</a>
        
        
        
          <li class="nav-link"><a href="/tag/rust/">Rust</a>
        
        
        
          <li class="nav-link"><a href="/tag/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/">ç¼–ç¨‹è¯­è¨€</a>
        
        
        
          <li class="nav-link"><a href="/tag/overlayfs/">OverlayFs</a>
        
        
        
          <li class="nav-link"><a href="/tag/%E5%AE%B9%E5%99%A8%E9%95%9C%E5%83%8F/">å®¹å™¨é•œåƒ</a>
        
        
        
          <li class="nav-link"><a href="/category/android/">android</a>
        
        
        
          <li class="nav-link"><a href="/category/%E5%88%A9%E5%99%A8/">åˆ©å™¨</a>
        
        
        
          <li class="nav-link"><a href="/category/%E5%AD%A6%E4%B9%A0-%E6%95%88%E7%8E%87/">å­¦ä¹ &æ•ˆç‡</a>
        
        
        
          <li class="nav-link"><a href="/category/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/">ç¼–ç¨‹è¯­è¨€</a>
        
        
        
          <li class="nav-link"><a href="/category/linux/">linux</a>
        
        
        
          <li class="nav-link"><a href="/category/%E5%86%85%E6%A0%B8/">å†…æ ¸</a>
        
        
        
          <li class="nav-link"><a href="/category/%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/">ä½“ç³»ç»“æ„</a>
        
        
        
          <li class="nav-link"><a href="/category/%E7%94%9F%E6%B4%BB/">ç”Ÿæ´»</a>
        
        
        
          <li class="nav-link"><a href="/category/%E8%99%9A%E6%8B%9F%E5%8C%96/">è™šæ‹ŸåŒ–</a>
        
        
        
          <li class="nav-link"><a href="/category/%E4%BA%91%E5%8E%9F%E7%94%9F/">äº‘åŸç”Ÿ</a>
        
        
        
          <li class="nav-link"><a href="/category/%E6%88%B7%E5%A4%96/">æˆ·å¤–</a>
        
        
        
          <li class="nav-link"><a href="/category/%E8%AE%BA%E6%96%87/">è®ºæ–‡</a>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
         -->
      </ul>
    </div>

    <div class="site-contact">

      <p><strong>Contact</strong></p>
      <ul class="social-media-list">
        <li>
          <a href="mailto:flyflyflypeng@gmail.com">
            <i class="fa fa-envelope-o"></i>
            <span class="username">flyflyflypeng@gmail.com</span>
          </a>
        </li>

        
          
          <li>
            <a href="https://twitter.com/flyflypeng_bear" title="Follow me on Twitter">
              <i class="fa fa-twitter"></i>
              <span class="username">flyflypeng_bear</span>
            </a>
          </li>
          
        
          
          <li>
            <a href="https://github.com/flyflypeng" title="Fork me on GitHub">
              <i class="fa fa-github"></i>
              <span class="username">flyflypeng</span>
            </a>
          </li>
          
        
          
          <li>
            <a href="https://www.instagram.com/FlyFlyPeng/" title="Follow me on Instagram">
              <i class="fa fa-instagram"></i>
              <span class="username">FlyFlyPeng</span>
            </a>
          </li>
          
        

      </ul>
    </div>

    <div class="site-signature">
      <p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
      <p class="text">Do one thing and do it well.
</p>
    </div>

  </div>

</footer>

<!-- Scripts -->
<script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/js/lightbox.min.js"></script>

<script type="text/javascript">
$(document).ready(function() {
  // Default syntax highlighting
  hljs.initHighlightingOnLoad();

  // Header
  var menuToggle = $('#js-mobile-menu').unbind();
  $('#js-navigation-menu').removeClass("show");
  menuToggle.on('click', function(e) {
    e.preventDefault();
    $('#js-navigation-menu').slideToggle(function(){
      if($('#js-navigation-menu').is(':hidden')) {
        $('#js-navigation-menu').removeAttr('style');
      }
    });
  });
});

</script>






  </body>

</html>
